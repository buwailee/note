\chapter{基础}
\ThisULCornerWallPaper{1}{../Pictures/8.png}

\section{代数结构}

这节就是罗列定义。

\para 设有两个集合$X$和$Y$，则称映射$f:X\times Y \to X$为集合$X$上的一个右\idx{作用}。称映射$g:Y\times X \to X$为集合$X$上的一个左作用。称映射$h:X\times X \to X$为集合$X$上的一个二元\idx{运算}。同样地，我们可以定义多元运算。

可以看到$\mathbb{R}$上的加法$f:\mathbb{R}\times \mathbb{R} \to \mathbb{R}$定义为$f(a,b)=a+b$是一个二元运算，同样可以检验乘法。再比如设$Y$是集合$X$上所有双射$f:X\to X$的集合，那么映射复合构成$Y$上的一个运算。

对于一个未知的运算或者作用，我们通常称之为“乘法”。左作用称为“左乘”，右作用称为“右乘”。对于运算$f(a,b)$通常直接记作$a*b$，或者再干脆一些省略中间的符号$*$，记作$ab$，读作$a$左乘$b$、$b$右乘$a$或$a$乘以$b$.

定义多个元素$\{a_i\,:\, 1\leq i \leq n\}$的乘法为
\[
	a_1a_2\cdots a_n=a_1(a_2a_3\cdots a_n)=a_1(a_2(a_3\cdots a_n))=\cdots,
\]
这是一个递归定义。

\para 设集合$X$上有一个运算$h:X\times X \to X$，将$h(a,b)$直接记作$ab$. 如果任取$a$, $b$, $c\in X$都成立
\[
	(ab)c=a(bc),
\]
则该运算被称为是满足\idx{结合律}(\idx{associative property})的。

\para 对于在字符串$a_1a_2\cdots a_n$中任意加括号构成的字符串，比如
\[
(a_1(a_2(a_3a_4)a_5))(a_6(a_7a_8a_9))a_{10},
\]
先预设一个$n=0$，我们从左往右开始计数，遇到`$($'则$n\to n+1$，并称该括号为第$n$层括号，遇到`$)$'则$n\to n-1$，直到最后一个字符。比如上式中，第一个和第四个`$($'都是第一层括号，而第二个和第五个`$($'是第二层括号。如果到达最右端字符的时候，得到了$n=0$，则上面的字符串称为$a_1a_2\cdots a_n$的一种加括号的方式。

\begin{pro}
设$\{a_i\in A\,:\, 1\leq i\leq n\}$是$A$中任意的一个有限集，且$A$上存在一种运算满足结合律。对于任意字符串$a_1a_2\cdots a_n$中任意加括号的方式，经过运算后，他们都等于$a_1a_2\cdots a_n$.
\end{pro}

\begin{proof} 对正整数$n$，记$[n]=\{1,2,\cdots,n\}$. 设$f:[m]\to [n]$是一个递增函数，则$f$被称为$[n]$的一个$m$-划分。由于是递增函数，所以$m\leq n$. 

考虑$\{a_i\, :\, 1\leq i\leq n\}$，对于$[n]$的任意一个$(2m)$-划分$k$，$k(i)=k_i$，我们都可以通过在在每一对$a_{k_{2i-1}}$和$a_{k_{2i}}$之间加一对括号定义出一个字符串
\[
	a_1a_2\cdots (a_{k_1}\cdots a_{k_2})a_{k_2+1}\cdots (a_{k_3}\cdots a_{k_4})\cdots (a_{k_i}\cdots a_{k_{i+1}})\cdots a_n,
\]
一个$m$对括号，这个字符串的最大层数是$1$。现在，当这个字符串看作元素之间相乘的时候，可以证明此时他等于$a_1a_2\cdots a_n$.

为此先证明如下特殊情况：对任意的正整数$n$和$k$以及元素$\{a_i\,:\, 1\leq i \leq n\}$成立
\[(a_1a_2\cdots a_{k})(a_{k+1}\cdots a_{n})=a_1a_2\cdots a_n.\]
首先注意到
\[
(a_1a_2\cdots a_{k})(a_{k+1}\cdots a_{n})=(a_1(a_2\cdots a_{k}))(a_{k+1}\cdots a_{n})=a_1((a_2\cdots a_{k})(a_{k+1}\cdots a_{n})),
\]
第二个等号来自于结合律。然后对$(a_2\cdots a_{k})(a_{k+1}\cdots a_{n})$进行同样的操作，如是归纳下去，由于$n$是有限的，归纳也是有限的，我们就可以得到
\[
(a_1a_2\cdots a_{k})(a_{k+1}\cdots a_{n})=a_1(a_2(a_3(\cdots (a_{k}(a_{k+1}\cdots a_{n})))))=a_1a_1a_2\cdots a_n.
\]

现在，假设有$m$对括号，多重乘积可能出现两种情况：一是$a_1a_2\cdots a_{k-1}(a_{k}\cdots a_n)$，即最后一对括号出现在最后，那么按照定义，他就等于$a_1a_2\cdots a_{k-1}a_{k}\cdots a_n$，这样就消去了最后一对括号。二是$a_1a_2\cdots$ $a_{k-1}(a_{k}\cdots a_l)$ $a_{l+1}\cdots a_n$，其中$a_1a_2\cdots a_{k-1}$中有$(m-1)$对括号，或者说$(a_{k}\cdots a_l)$是最后一对括号。利用定义和上面的结论可以得到
\begin{align*}
	a_1a_2\cdots a_{k-1}(a_{k}\cdots a_l)a_{l+1}\cdots a_n&=a_1a_2\cdots ((a_{k}\cdots a_l)(a_{l+1}\cdots a_n))\\
	&=a_1a_2\cdots a_{k-1}(a_{k}\cdots a_n)\\
	&=a_1a_2\cdots a_{k-1}a_{k}\cdots a_n.
\end{align*}
这样我们就消去了最后一对括号。如是往复，对$m$进行有限归纳可以消去全部的括号，得到$a_1\cdots a_n$.

我们已经对任意字符串$a_1a_2\cdots a_n$最大括号层数为$1$的所有可能加括号方式证明了，在满足结合律的时候等于$a_1a_2\cdots a_n$.

先设最大的层数为$N$，对所有的$(N-1)$层括号，他里面的最大括号层数为1，利用上面的结论可以将这层内所有的括号消去，则最大层数降为$(N-1)$，如是往复，经过有限次归纳，就得到了他最终将等于$a_1a_2\cdots a_n$.\end{proof} 

这个结论就是说，对于满足结合律的运算，有限个元素相乘的结果不依赖于他加括号的方式。

\para 有一个非空集合$G$和其上的二元运算$*$，或者记作$(G,*)$，称为一个\idx{群}(\idx{group})，如果满足：

\no{1}结合律：对于任意$a$, $b$, $c\in G$，有$(a*b)*c=a*(b*c)$；

\no{2}单位元：对于任意的$a\in G$，存在一个元素$e\in G$，使得$e*a=a*e=a$；

\no{3}反元素：对于每一个$a\in G$，存在一个元素$b\in G$，使得$b*a=a*b=e$.

$a$的反元素通常记作$a^{-1}$.此外如果不产生歧义，我们可以直接称呼$G$为一个群。显然$(\mathbb{R},+)$是一个群，单位元是0，$a^{-1}=-a$.将$\mathbb{R}$去掉了$0$之后的集合记作$\mathbb{R}-\{0\}$，则$(\mathbb{R}-\{0\},\cdot)$构成一个群，单位元是$1$，$a^{-1}=1/a$.

如果有群$(G,*)$，对于任意的$a$, $b\in G$满足$a*b=b*a$，则称$(G,*)$是一个\textit{交换群}\index{群!交换群}，或者称为\idxx{群}{Abel群}。交换群的运算一般是记作加法的。

\para 我们称呼一个三元组$(R,+,\cdot)$为一个\idx{环}(\idx{ring})，如果满足下列性质：

\no{1} $(R,+)$构成一个交换群，运算称为加法，其中的单位元记作$0$，$a$的反元素记作$-a$;

\no{2} $(R,\cdot)$中的运算满足结合律，称为乘法。并且，在$R-\{0\}$中含有乘法的单位元，记作$1$. 如果$a$关于$1$有逆，则逆写作$a^{-1}$.

\no{3} 乘法满足分配律：对任意$a$, $b$, $c \in R$，成立$a\cdot(b+c)=a\cdot b+a\cdot c$以及$(b+c)\cdot a=b\cdot a+c\cdot a$.

同样地，如果不产生歧义，我们可以直接称呼$R$为一个环，而且略去乘法的符号。任取$a\in R$，由于
\[
	0a=(0+0)a=0a+0a,
\]
所以$0a=0$，同理$a0=0$. 如果在$R$中有$1=0$，则对任意的$r\in R$成立$r=1r=0r=0$. 这样的环称为零环，零环的地位在集合里面大概就类似空集。下面我们所讨论的环，一般而言不会是零环，即我们会假设$0\neq 1$.

如果$R$中的乘法是可交换的，则称$R$是一个\idxx{环}{交换环}。有些作者在环的定义中会去掉乘法单位元，称我们这里定义的环为含幺环。

和群不同的是，环乘法不一定是可逆的（即对$a$存在一个$b$使得$ab=1$），比如$0$，对于任意的$a\in R$都有$a0=0\neq 1$，所以$0$一定不是可逆的。如果一个环除了零之外的元素全部可逆，则称他为一个除环。交换除环被称为\idx{域}(\idx{field})。

在后面，除非特殊申明，环全部假设为交换含幺环。

\para 设$(M,+)$是一个交换群，$R$是一个环，如果有一个左乘$\mu:R\times M\to M$，左乘符号下面省略，使得对任意的$r$, $s\in R$以及$m$, $n\in M$，成立
\[
	(rs)m=r(sm),\quad r(m+n)=rm+rn,\quad (r+s)m=rm+sm,\quad 1m=m,
\]
则称呼$M$是一个左$R$-\idx{模}，同理可以定义右$R$-模。任意的含幺环$R$显然是一个$R$-模。

由于
\[
	0m=(0+0)m=0m+0m,
\]
所以$0m=0$，注意等号两边的零是不同的。类似地，可以证明$r0=0$. 

如果$R$是交换环，则我们可以不区分左$R$-模和右$R$-模，只要等同$rm$和$mr$即可。我们后面谈论的基本都是这种模。

\para $\zz$显然是一个交换群，当然也是一个交换环。不太平凡的一点是，任意的交换群$G$可以看成$\zz$-模。这是因为对任意的$n\in \zz$和任意的$a\in G$，我们做出如下定义：如果$n>0$，定义$na$为$n$个$a$相加，如果$n=0$，定义$na=0$，如果$n<0$，定义$na=-((-n)a)$. 不难检验这是确实是一个$\zz$-模。

除了交换群之外，还有一类重要的模，\idx{矢量空间}。设$k$是一个域，则任意$k$-模$V$被称为$k$-矢量空间，$V$中的元素被称为矢量。

\para 设$\mu:H\times G\to G$为一个$G$上的左作用（一般是乘法），$K$是$G$的一个子集，记
\[
	HK=\{ab\,:\,a\in H,b\in K\}\subset G.
\]
特别地，当$H$为单点集$\{f\}$的时候，$\{f\}K$通常缩略写作$fK$. 或者当$K$是单点集$\{a\}$的时候，也缩略写作$Ha$.

设$H'\subset H$，以及$K'\subset K$，则有显然的包含关系
\[
	H'K\subset HK,\quad HK'\subset HK.
\]

% 对于环$R$的两个子集$H$和$K$，他们的加法就是上述左作用的一个特例
% \[
% 	H+K=\{a+b\,:\,a\in H,b\in K\}\subset R.
% \]
% 然后考虑到$R$上也有乘法，所以我们定义
% \[
% 	HK=\left\{\sum_i a_i b_i\,:\,a_i\in H,b_i\in K\right\}\subset R,
% \]
% 其中求和是任意有限求和。

\para 设$G$是一个群，$H$是他的一个子集。群运算$\mu$限制在$H\times H$得到了运算$\mu|_{H\times H}:H\times H\to G$. 如果$\im\mu|_{H\times H}\subset H$，则$(H,\mu)$也构成了一个群，他被称为$G$的一个\idxx{群}{子群}。最后一句话就是说，$H$中的任意两个元素相乘依然在$H$中，再或者用上面的写法，$HH\subset H$.

类似地，如果$R$是一个环，$S$是他的一个子集。如果对$R$的交换群结构，$S$是他的子群，且$SS\subset S$，则$S$被称为$R$的一个\idxx{环}{子环}。子环一般而言不用含有单位元。

同样，如果$M$是一个左$R$-模，$N$是他的一个子集。如果对$M$的交换群结构，$N$是他的子群，且$RN\subset N$，则$N$被称为$M$的一个\idxx{模}{子模}。

一个群/环/模的子群/环/模如果作为子集是真子集，则称其为真子群/环/模。

\begin{para}
注意到环$R$本身可以看成一个$R$-模，他的子模被称为理想。
\end{para}

显然$\{0\}$和$R$本身是$R$的理想，前者被称为零理想，后者被称为单位理想，这两者往往被称为平凡理想，因为我们感兴趣的理想往往不是他们。

设$a\in R$，则$aR$也是$R$的一个\idx{理想}，被称为\idxx{理想}{主理想}，有时候也记作$(a)$或者$\langle a\rangle$. 由于$\{0\}=0R$以及$R=1R$，零理想和单位理想都是主理想。主理想$(a)$一般也称作被$a$生成的主理想。

单位理想名字中的单位来自于可逆元的英文unit：考虑一个可逆元$a\in R$，由于存在$a^{-1}$，所以任取$r\in R$，都有$r=a(a^{-1}r)\in (a)$，所以$(a)=R$. 这就是说可逆元生成的主理想都是单位理想。

设$k$是一个域，则他没有非平凡理想：考虑$k$的一个非零理想$\mathfrak{a}$，他包含一个$a\neq 0$，所以$(a)\subset k\mathfrak{a} \subset k$，但是由于$a$可逆，所以$(a)=k\subset k\mathfrak{a} \subset k$，这也就推出了$k\mathfrak{a}=k$，然后由理想的定义$k\mathfrak{a}\subset \mathfrak{a}$就推出了$\mathfrak{a}=k$.

\section{同态与同构基本定理}

\para 设$G$和$H$是两个群，若映射$f:G\to H$满足
\[
	f(e_G)=e_H,\quad f(ab)=f(a)(b),
\]
则称$f$是一个群\idx{同态}（\idx{homomorphism}）。可以看到，群同态将单位元映射到单位元，将乘法映成乘法，基本保持了群的结构。如果还有一个群同态$g:H\to G$使得$fg=\id_H$以及$gf=\id_G$，则$f$或者$g$被称为一个群同构，通常会把$g$记作$f^{-1}$. 显然，一个群同构是一个双射，既单又满。如果两个群之间存在群同构，则称呼这两个群是同构的。

后面我们不再区分两个不同群的单位元的符号，基本上属于哪个群从上下文中都是清楚的。

\para 设$R$和$S$是两个环，若映射$f:R\to S$是交换群同态，且$f(rs)=f(r)f(s)$以及$f(1)=1$，则称$f$是一个环同态。类似地，还有环同构。

设$M$和$N$是两个$R$-模，若映射$f:M\to N$是交换群同态，且任取$r\in R$以及$m\in M$成立$f(rm)=rf(m)$，则称$f$是一个$R$-模同态。类似地，还有同构。

\para 任取一个同态$f:A\to B$，这里$A$和$B$可以是群、环、$R$-模，则$f(A)$自然地有一个$B$的子群、子环、子$R$-模的结构，称作同态$f$的像，记作$\im(f)$或者$f(A)$。如果$\im(f)=B$，则这个同态被称为满同态。

对群的情况，考虑原像集$f^{-1}(e)$. 任取$a$, $b\in f^{-1}(e)$，由于$f(ab)=f(a)f(b)=e$，所以$ab\in f^{-1}(e)$. 因此$f^{-1}(e)$是$A$的一个子群，记作$\ker(f)$，称作同态$f$的核。如果$\ker(f)=\{e\}$，则这个同态被称为单同态。

对环的情况，先只考虑他的加法群结构，则$\ker(f)=f^{-1}(0)$. 任取$a\in \ker(f)$以及$r\in A$，由于$f(ra)=f(r)f(a)=0$，所以$ra\in \ker(f)$或者$A\ker(f)\subset \ker(f)$，这就意味着$\ker(f)$是$A$的一个理想。

对$R$-模的情况，先只考虑他的加法群结构，则$\ker(f)=f^{-1}(0)$. 任取$a\in \ker(f)$以及$r\in A$，由于$f(ra)=rf(a)=0$，所以$ra\in \ker(f)$或者$R\ker(f)\subset \ker(f)$，这就意味着$\ker(f)$是$A$的一个子模。

\para 有一个自然的单同态：考虑$A$是$B$的子群/环/$R$-模，则$\id_B|_A:A\to B$就是一个单同态。此时这个映射（同态）被称为含入映射（同态），一般而言我们会略去他的符号，用一个弯曲的箭头写作$A\hookrightarrow B$. 正如前面看到的，设$\rho:A\to C$是一个同态，则他的核是$A$的子群/环/$R$-模，此时有$\ker\rho\hookrightarrow A$.

设$\{e\}$是平凡群，则同态$f:\{e\}\to A$只可能是$f(e)=e$，因此平凡群$\{e\}$可以看成任意群的子群，从他到任意群的同态只有一个同态，即含入同态。而任意同态$g:A\to \{e\}$满足$\ker(g)=A$，他被称为零同态。 类似的，在环中，零环$\{0\}$也提供了同样的作用，在$R$-模中，零模$\{0\}$也类似。

\para 若有一族同态$f_i:A_i\to A_{i+1}$满足$\im f_i=\ker f_{i+1}$，则列
\[
	\cdots \xrightarrow{f_{i-1}}A_i \xrightarrow{f_i} A_{i+1} \xrightarrow{f_{i+1}} A_{i+1}\xrightarrow{f_{i+1}}\cdots
\]
被称为\idx{正合}的。在正合列中，平凡群一般写作$1$，零环和零模则写作$0$，从平凡群出发或者到平凡群的同态记作$1$，零环和零模的则记作$0$，通常略去他们的符号，因为这些同态我们是清楚的。

正合列可以用来表示一个同态是否是单射或者满射。考虑正合列$0\to A\xrightarrow{f} B$，由于$\ker(f)=\im(0\to A)=\{0\}$，所以$f$是一个单射。考虑正合列$A\xrightarrow{f} B\to 0$，由于$\im f=\ker(B\to 0)=B$，所以$f$是一个满射。

在正合列中，短正合列尤其重要，他写作
\[
	0\to A \xrightarrow{f} B \xrightarrow{g} C\to 0,
\]
其中$f$是单射，而$C$是满射。如果有如下正和列
\[
	0\to A \xrightarrow{f} B \to 0,
\]
这就意味着同态$f$即是单射又是满射。下面的命题告诉我们，$f$此时是一个同构。

\begin{pro}
一个（群/环/$R$-模）同态是同构当且仅当他既是单的又是满的。
\end{pro}

\begin{proof}
一个同构肯定既是单的又是满的。反过来，设$f: A\to B$既是单的又是满的，则对$b\in B$，唯一存在$a\in A$使得$f(a)=b$，定义
\[
	\begin{array}{ccccc}
		g &:&B &\to& A,\\
		g &:&b &\mapsto& a.
	\end{array}
\]
下面检验这是一个同态。

对于群而言，设$g(b_1)=a_1$和$g(b_2)=a_2$，则只要检验$g(b_1b_2)=a_1a_2$，由于$f(a_1a_2)=f(a_1)f(a_2)=b_1b_2$以及$f$是一个单射就得出了$g(b_1b_2)=a_1a_2=g(b_1)g(b_2)$. 另外，显然$g(e)=e$，所以$g$是一个同态。

对于环而言，加法群同态部分已经由群的结论得到了，只要检验乘法即可。而乘法部分和群的情况是一模一样的。

对于$R$-模的情况，加法群同态部分已经由群的结论得到了，只要检验标量乘法即可。设$g(b)=a$，以及$g(rb)=a'$. 由于$f(a')=rb$以及$rf(a)=f(ra)=rb$，所以由$f$是一个单射也就得到了$a'=ra$，故$g(rb)=rg(b)$，所以$g$是一个同态。

最后显然$f\circ g =\id_B$以及$g\circ f=\id_A$，所以$f$是一个同构，而他的逆$g$常常记作$f^{-1}$.
\end{proof}

\para 设$f:G\to H$是一个群同态，前面说过$\ker(f)$是$G$的一个子群。我们问反过来的一个问题，什么时候子群可以称为一个同态的核。为此，先看看核有什么性质，设$h\in \ker(f)$，则任取$g\in G$有
\[
	f\left(ghg^{-1}\right)=f(g)f(h)f(g)^{-1}=f(g)ef(g)^{-1}=e,
\]
所以$ghg^{-1}\in \ker(f)$，或者$gh \in \ker(f)g$，再或者$g\ker(f)\subset \ker(f)g$. 然后再考虑$g\to g^{-1}$我们就得到了反向包含，合起来就得到了$g\ker(f)=\ker(f)g$对任意$g\in G$都成立。

我们抽象出这个性质：如果一个$G$的子群$H$满足对任意的$g\in G$都成立$gH=Hg$，则$H$被称为$G$的\idxx{群!子群}{正规子群}。

一般而言，子群不是正规子群。但是，对于交换群，$gh=hg$，所以任意子群都是正规子群。反过来也不对，任意子群是正规子群也不一定是交换群。

\para 在继续回答上面的问题之前，我们先看看陪集。设$H$是$G$的一个子群，可以自然地定义一个等价关系：子集族$\{gH\,:\, g\in G\}$构成了$G$的一个划分。

证明是简单的。显然他们的并等于$G$，只要证明不交性即可，如果$gH\cap hH\neq \varnothing$，则存在$k\subset gH\cap hH$，故$g^{-1}k$和$h^{-1}k$属于$H$，由于$H$是子群，则$g^{-1}k\left(h^{-1}k\right)^{-1}=g^{-1}h\in H$，因此$g^{-1}hH=H$也就堆出了$hH=gH$.

这样定义的等价类被称为一个左陪集(coset)，当然还可以类似定义右陪集。对于陪集，有如下简单性质：$|gH|=|H|$. 这点只要注意到$gh_1=gh_2$可以推出$h_1=h_2$即可。对于有限群就得到了Lagrange定理：子群的元素个数可以整除群的元素个数，除出来就是陪集的个数。

\para 对于正规子群$H$而言，由于$gH=Hg$，所以正规子群的左陪集和右陪集相同。将$gH$记作$\bar{g}$，我们证明$\{\bar{g}\,:\, g\in G\}$构成了一个群。

首先是乘法，他来自于$G$的乘法：
\[
	\bar{g}\bar{h}=gHhH=HghH=H(gh)H=(gh)HH=(gh)H=\overline{gh}.
\]
从乘法定义看出看出，单位元是$\bar{e}$，而$\bar{g}$的逆就是$\overline{g^{-1}}$. 因此$\{\bar{g}\,:\, g\in G\}$构成了一个群，他被记作$G/H$，称作$G$关于$H$的商群，或者说$G$模掉$H$.

注意到，在定义乘法的时候，我们利用了正规子群的性质。这是非常关键的。

\para 前面我们看到了，任意同态的核都是正规子群。反过来，我们问过什么时候子群是一个同态的核。下面我们做出回答，任何正规子群都可以实现为一个同态的核。这就是说，同态的核刚好就是正规子群，不多不少。

设$H$是$G$的一个子群，我们定义一个同态
\[
	\begin{array}{ccccc}
		\pi &:&G &\to& G/H,\\
		\pi &:&g &\mapsto& \bar{g}.
	\end{array}
\]
利用$\bar{g}\bar{h}=\overline{gh}$可以看出他是一个同态，而且是满同态，且$\ker(\pi)=\bar{e}=H$. 这就证明了我们的论断。

使用短正合列，我们可以将上面的结论总结为：
\[
	1\to H \hookrightarrow G \xrightarrow{\pi} G/H\to 1.
\]

\para 类似于商群，我们可以定义出商环。设$\mathfrak{a}$是$R$的任意一个理想，作为交换群，$\mathfrak{a}$是$R$的正规子群，所以可以定义出商群$R/\mathfrak{a}=\{\bar{r}=r+\mathfrak{a}\,:\, r\in R\}$，换而言之，$r\in \bar{s}$当且仅当$r=s+a$，其中$a\in \mathfrak{a}$. 我们下面在$R/\mathfrak{a}$上定义出一个环结构。

我们定义$R/\mathfrak{a}$中的乘法为$\bar{r}\bar{s}=\overline{rs}$. 注意到这并不是$R$上的两个子集的乘法。这个乘法的定义是合理的，设$\overline{r'}=\bar{r}$，即$r'+a=r$, 以及$\overline{s'}=\bar{s}$，即$s'+b =s$，则
\[
	rs=(r'+a)(s'+b)=r's'+(r'b+as'+ab),
\]
其中$r'b+as'+ab\in \mathfrak{a}$，因为$\mathfrak{a}$是一个理想。故$\overline{rs}=\overline{r's'}$. 剩下的环的性质的检验都是直接的。

\para 同样的，我们可以定义出商模。设$M$是一个$R$-模，而$N$是$M$的任意一个子模，作为交换群可以定义出商群$M/N=\{\bar{m}=m+N\,:\, m\in M\}$. 我们下面在$M/N$上定义出一个$R$-模结构。

定义$M/N$中的标量乘法为$r\bar{m}=\overline{rm}$.这个乘法的定义是合理的，设$m'=m+n$，其中$n\in N$，则
\[
	rm'=rm+rn
\]
其中$rn\in N$，因为$N$是一个理想。故$\overline{rm}=\overline{rm'}$. 剩下的模的性质的检验都是直接的。

\begin{thm}[同构基本定理]
设$f:A\to B$是一个（群/环/$R$-模）同态，若存在同态$g: A\to B$使得$\ker f\subset \ker g$，则他诱导了一个同态$\bar{g}:A/\ker{f}\to B$. 如果$g$是满同态，则$\bar{g}$是满同态。特别地，如果$f$是满同态，则$\bar{f}: A/\ker{f}\to B$是一个同构。
\end{thm}

\begin{proof}
	对于群的情况，$g(\ker f)=e$，$g(a\ker f)=g(a)$. 对于环和$R$-模的情况，$g(\ker f)=0$，$g(a+\ker f)=g(a)$. 所以我们可以定义$\bar{g}(\bar{a})=g(a)$，不难检验这是一个（群/环/$R$-模）同态。并且$g$是满的时候，$\bar{g}$是满的。

	现在假设$f$是满同态，则$\bar{f}$是满同态。我们剩下的只要证明$\bar{f}$是个单射，或者$\ker(\bar{f})=\{\bar{e}\}$即可。设$\bar{f}(\bar{a})=f(a)=e$，于是$a\in \ker(f)=\bar{e}$，因此$\bar{a}\cap \bar{e}\neq\varnothing$，于是我们也就得到$\bar{a}=\bar{e}$，所以$\ker(\bar{f})=\{\bar{e}\}$. 

	由于$\bar{f}$是满同态也是单同态，所以他是一个同构。
\end{proof}

一般只有最后一点被称为同构基本定理，但是前面的一部分是商群/环/$R$-模的泛性质，所以我们特地写出来。下面我们写两个常用的同构，他们是同构基本定理的简单推论。由于会谈到子模，先做观察：子模的子模依然是子模。

\para 设$L\subset M \subset N$是有包含关系的三个$R$-模，则商映射$\rho:N\to N/M$诱导了一个满射$\bar{\rho}:N/L \to N/M$使得$\ker \bar{\rho}=M/L$. 使用同构基本定理，我们就得到了同构$N/M=(N/L)/(M/L)$.

考虑商映射$\rho:N\to N/M$，由于$L\subset \ker \rho=M$，由同构基本定理，诱导了一个满射$\bar{\rho}:N/L \to N/M$，接下来只要求他的核即可。任取$\bar{x}\in N/L$以及代表元$x\in N$，由于$\bar{\rho}(\bar{x})=\rho(x)$，所以$\bar{\rho} (\bar{x})=0$当且仅当$x\in \ker \rho =M$，这就告诉我们$\ker \bar{\rho}=M/L$.

\para \label{modiso1}设$M_1$和$M_2$是$M$的子模，则复合$M_2\hookrightarrow M_1+M_2 \to (M_1+M_2)/M_1$是一个满射，他的核是$M_1\cap M_2$，因此有同构
\[
	(M_1+M_2)/M_1\cong M_2/(M_1\cap M_2).
\]

\para 可以将上面的命题翻译到群上去。不过由于只有正规子群才可以谈商群，所以我们必须更加谨慎。两个相应的同构被如下表述：

\begin{itemize}
\item 给定群$G$，$N$和$M$为$G$的正规子群，满足$M$包含于$N$，则$N/M$是$G/M$的正规子群，且有如下的群同构： $ (G/M)/(N/M)\cong G/N$.

\item 给定群$G$ 、其正规子群$N$ 、其子群$H$ ，则$N\cap H$是$H$ 的正规子群，且有群同构如下：$H/(H\cap N)\cong HN/N$
\end{itemize}

证明和模的情况是类似的，只不过必须更加小心而已。对于环，我们一般谈理想，所以可以应用模的定理（作为模，理想是子模）。

\para 设$G$和$G'$是两个群，$f:G\to G'$是一个群同态，设$H'\subset G'$是一个子群，则$f^{-1}(H')$是一个$G$的子群。事实上，任取$g$, $h\in f^{-1}(H')$，于是$f(gh)=f(g)f(h)\in H'$也就推出了$gh\in f^{-1}(H')$. 

类似地，设$M$和$M'$都是$R$-模，而$f:M\to M'$是一个$R$-模同态，考虑一个子模$N'\subset M'$，则$f^{-1}(N')$是$M$的一个子模。事实上，加法群结构来自于群的结论，任取$r\in R$以及$x\in f^{-1}(N')$，于是$f(rx)=rf(x)\in N'$推出了$rx\in f^{-1}(N')$. 

\section{理想}

\para 理想是环$R$看成$R$-模时候的子模。一个理想被集合$S\subset R$生成是指在$R$-模意义上生成的子模，即$S$中元素的任意有限线性组合，我们将其记作$(S)$或者$\langle S\rangle$，当$S$是单元素集的时候，这就是主理想，当$S$是有限集的时候，时常就写成$(S)=(f_1$, $\cdots$, $f_n)$或者$\langle f_1$, $\cdots$, $f_n\rangle$. 如果指标需要用一个指标集表示，那么就通常写作$\langle f_i\rangle_{i\in I}$或者$\langle f_i\,:\,i\in I\rangle$. 一个理想生成的理想自然就是他本身。

\para 在不同的理想之间可以定义运算，设$\mathfrak{a}$和$\mathfrak{b}$是$R$的两个理想，则
\[
\mathfrak{a}+\mathfrak{b}=\{a+b\,:\,a\in\mathfrak{a},\,b\in\mathfrak{b}\}
\]
是一个理想。由于$\mathfrak{a}$, $\mathfrak{b}\subset \mathfrak{a}+\mathfrak{b}$，所以$\mathfrak{a}\cup\mathfrak{b}\subset \mathfrak{a}+\mathfrak{b}$. 一般而言，两个理想的并不是理想，但是两个理想的并生成的理想实际上就是两个理想的和。

两个理想的交显然还是一个理想（这可以类比两个子群的交还是子群），两个理想$\mathfrak{a}$和$\mathfrak{b}$的乘积$\mathfrak{a}\mathfrak{b}$被定义为集合$\{ab\,:\,a\in\mathfrak{a},\,b\in\mathfrak{b}\}$生成的理想。由于$\mathfrak{a}\mathfrak{b}\subset \mathfrak{a}$以及$\mathfrak{a}\mathfrak{b}\subset \mathfrak{b}$，所以有包含关系$\mathfrak{a}\mathfrak{b}\subset \mathfrak{a}\cap \mathfrak{b}$.

设$(a)$和$(b)$是环$R$的两个主理想，则$(a)(b)=(ab)$. 实际上，左手边的元素由所有$(ra)(sb)=rs(ab)$生成，其中$r$, $s$走遍$R$. 所以$(a)(b)\subset (ab)$. 反过来，因为$ab\in (a)(b)$，所以$(ab)\subset (a)(b)$.

最后，给定$R$的两个理想$\mathfrak{a}$和$\mathfrak{b}$，定义$(\mathfrak{a}:\mathfrak{b})$为$\{r\in R\,:\, r\mathfrak{b}\subset \mathfrak{a}\}$，这是一个理想，因为若$x\in (\mathfrak{a}:\mathfrak{b})$，由于$\mathfrak{a}$是一个理想，则$yx\mathfrak{b}\subset y\mathfrak{a}\subset \mathfrak{a}$或者$xy\in (\mathfrak{a}:\mathfrak{b})$. 当$\mathfrak{a}=(a)$是一个主理想的时候，通常会略去主理想的括号，写作$(a:\mathfrak{b})$，同样，如果$\mathfrak{b}=(b)$是主理想，会写做$(\mathfrak{a}:b)$. $(\mathfrak{a}:\mathfrak{b})$被称为理想$\mathfrak{a}$关于理想$\mathfrak{b}$的商，比如在整数环内，$(6:2)=(3)$.

\para 称一个环$R$是一个整环，如果任取非零的$a$, $b\in R$，可以推出$ab\neq 0$. 一般而言，一个环不是整环。如果$ab=0$但$a$和$b$都不等于零，则这样的$a$或者$b$被称为一个零因子。零显然是一个零因子。而整环就是一个没有非零零因子的环。换而言之，在整环里面，消去律是成立的。

考虑一个单同态$f:R\to S$，如果$S$是一个整环，则$R$也是一个整环。为了证明他，考虑到$ab=0$等价于$f(ab)=f(a)f(b)=0$，由于$S$是整环，所以$f(a)=0$或者$f(b)=0$，再由单同态就得到了结论。作为推论，整环的子环也一定是整环。

如果读者熟悉多项式环，这里可以看到另一大类例子，整环上的多项式环也是整环：设多项式$f$以及$g$都不为零，则它们的首项系数$a$与$b$不为零，因此$fg$的首项系数$ab$不为零，也就是说$fg\neq 0$.

\para 一个理想$\mathfrak{p}$被称为素理想，如果$R/\mathfrak{p}$是一个整环。一个理想$\mathfrak{m}$被称为极大理想，如果$R/\mathfrak{p}$是一个域。由于域是整环，所以极大理想是素理想，反之不然。由于$R=R/(0)$，所以只有在整环里面，零理想才是素理想。

\para 设$R$是一个环，$I(R)$是$R$所有理想的集合，上面按照包含构成了一个偏序，即$\mathfrak{a}\leq \mathfrak{b}$当且仅当$\mathfrak{a}\subset \mathfrak{b}$. 设$\mathcal{F}$是$I(R)$的一个子集，记$\mathcal{F}^c=I(R)-\mathcal{F}$.

极大理想的命名就来自于这个偏序，他是所有真理想构成的集合中的极大元素。对于任意的真理想链，他们的并所生成的理想是真理想。并且由于$R$肯定有一个理想$(0)$，所以由Zorn引理，$R$中存在在上述偏序下极大的理想，下面检验这就是上面说的极大理想。设$\mathfrak{m}$是这样一个理想，$a\notin \mathfrak{m}$，则$(a)+\mathfrak{m}$是一个严格比$\mathfrak{m}$大的理想，由于$\mathfrak{m}$的极大性，没有比他大的真理想了，所以$(a)+\mathfrak{m}=R$. 因此，$1$可以写成$ra+m=1$的形式，在$R/\mathfrak{m}$中即$\bar{r}\bar{a}=1$，所以$\bar{a}$有逆。又因为$a$是在$R-\mathfrak{m}$中任取的，所以$R/\mathfrak{m}$是一个域。

反过来，如果$R/\mathfrak{m}$是一个域，则不存在$\mathfrak{m}$更大的真理想。假设如果存在$\mathfrak{a}$比$\mathfrak{m}$严格大，则有自然的商同态$\pi:R/\mathfrak{m}\to R/\mathfrak{a}$，由于$R/\mathfrak{m}$是一个域且$\pi$是满射，则$\ker \pi$作为域的理想只能是零理想，这样也就推出了$\pi$是一个同构，这与$\mathfrak{a}$比$\mathfrak{m}$严格大矛盾。

从可操作性来看，一开始的定义比这个极大理想的等价定义要方便不少。

\para \label{oka}我们看到，极大理想是素理想。下面我们要推广这个结论。实际上，满足一些条件的极大的理想也会是素理想。而极大的存在性往往是其他条件保证的，比如Zorn引理，再比如极大性条件。

给定一族理想$\mathcal{F}$，对$a\in R$以及$R$的一个理想$\mathfrak{a}$，如果$\mathfrak{a}+(a)$, $(\mathfrak{a}:a)\in \mathcal{F}$可以推出$\mathfrak{a}\in \mathcal{F}$，则称$\mathcal{F}$是Oka理想族\footnote{\url{http://www.bowdoin.edu/~reyes/oka1.pdf}}。对$a$, $b\in R$以及$R$的一个理想$\mathfrak{a}$，如果$\mathfrak{a}+(a)$, $\mathfrak{a}+(b)\in \mathcal{F}$可以推出$\mathfrak{a}+(ab)\in \mathcal{F}$，则称$\mathcal{F}$是Ako理想族。

对于单位理想$(1)$，由于任取$a\in R$都有$a+(1)=(1)$以及$(1:a)=(1)$，所以对任意的Ako理想族或者Oka理想族$\mathcal{F}$，$\mathcal{F}$都包含单位理想。

\begin{pro} 如果$\mathcal{F}$是Oka理想族或者Ako理想族，那么$\mathcal{F}^c$中极大的理想是素理想。
\end{pro}

\begin{proof}
	假设$\pp$是$\mathcal{F}^c$中极大的理想，但不是素理想。因为$\pp$不是单位理想，所以存在$a$, $b\not\in \pp$但$ab\in\pp$. 此时$(\pp:a)$和$\pp+(b)$都比$\pp$严格大，因为他们都包含$b$，同样$\pp+(a)$严格比$\pp$大，所以他们都属于$\mathcal{F}$. 但此时$\pp=\pp+(ab)\in \mathcal{F}^c$或者$\pp=\pp+(ab)\not\in \mathcal{F}$，所以$\mathcal{F}$既不是Ako理想族，也不是Oka理想族。矛盾。
\end{proof}

作为应用，先证明如下理想族是Ako或者Oka理想族：

1. 只有单位理想的理想族。

2. $R$的所有有限生成理想构成的集合。

3. $R$的所有主理想的理想构成的集合。

4. 设$S\subset R$是一个对乘法封闭的子集，$R$中与$S$相交的理想构成的集合。

\begin{proof}
	1. 这是Ako理想族。如果$\mathfrak{a}+(a)=(1)$以及$\mathfrak{a}+(b)=(1)$，那么存在$x$, $y\in \mathfrak{a}$使得$x+a=1$以及$y+b=1$，于是$ab=(1-x)(1-y)$或者$(x+y-xy)+ab=1$，所以$\mathfrak{a}+(ab)=(1)$. 也是Oka理想族，如果$(\mathfrak{a}:a)=(1)$，那么$a\in \mathfrak{a}$，此时$\mathfrak{a}+(a)=\mathfrak{a}$. 因此$\mathfrak{a}+(a)=1$也推出了$\mathfrak{a}=(1)$.

	2. 这是Oka理想族。如果$\mathfrak{a}+(a)$和$(\mathfrak{a}:a)$是有限生成理想。设$\mathfrak{a}+(a)=\langle x_i+r_ia \rangle_{i\in I}$以及$(\mathfrak{a}:a)=\langle y_j\rangle_{j\in J}$，其中$I$, $J$都是有限的指标集。任取$x\in \mathfrak{a}$，由于$x\in \mathfrak{a}+(a)$，所以
	\[
		x= \sum_{i\in I}s_i(x_i+r_ia)=\sum_{i\in I}s_ix_i+\sum_{i\in I}s_ir_ia,
	\]
	由于$a\sum_{i\in I}s_ir_i=x-\sum_{i\in I}s_ix_i\in \mathfrak{a}$，因此$\sum_{i\in I}s_ir_i\in (\mathfrak{a}:a)$，可以被$\{y_j\}_{j\in J}$生成。所以$\mathfrak{a}$被$\{x_i$, $y_ja\}_{i\in I,j\in J}$生成。

	3. 这是Oka理想族。如果$\mathfrak{a}+(a)=(b)$是主理想且$(\mathfrak{a}:a)=(c)$也是主理想，如果$a\in \mathfrak{a}$，则$\mathfrak{a}=(b)$是主理想。假设$a\not\in\mathfrak{a}$，存在$x\in \mathfrak{a}$使得$x+a=b$，所以$bc=xc+ac\in \mathfrak{a}$，或者$(bc)\subset \mathfrak{a}$. 反过来，任取$x\in \mathfrak{a}$,由于$\mathfrak{a}+a=\mathfrak{b}$，所以存在$r$, $s\in R$使得$x=rb$以及$a=sb$. 因此$ra=rsb=sx\in\mathfrak{a}$给出了$r\in (\mathfrak{a}:a)=(c)$，于是$y=rb\in (c)(b)=(bc)$.

	4. 这是Ako理想族。设$\pp+(a)$与$S$交于$x$，$\pp+(b)$与$S$交于$y$，则$xy\in (\pp+(a))(\pp+(b))\subset \pp+(ab)$，但由于$S$对乘法封闭，$xy\in S$，所以$(\pp+(ab))\cap S\neq \varnothing$.
\end{proof}

所以上述命题告诉我们：在保证存在性的前提下，
\begin{compactenum}[~~~1.]
\item 极大理想是素理想。
\item 所有非有限生成的理想中极大的是素理想。
\item 所有非主理想的理想中极大的是素理想。
\item 所有与某乘性子集不交的理想中极大的是素理想。
\end{compactenum}

\begin{pro} \label{primeav}设$R$是一个环，而$\mathfrak{a}_1$, $\cdots$, $\mathfrak{a}_n$是一族理想，还有一个理想$\mathfrak{b}$满足$\mathfrak{b}\subset \bigcup_i \mathfrak{a}_i$. 如果$\mathfrak{a}_1$, $\cdots$, $\mathfrak{a}_n$中至多只有两个不是素理想，则存在一个$i$使得$\mathfrak{b}\subset \mathfrak{a}_i$. 如果将包含改成等号，命题依然成立。
\end{pro}

\begin{proof}
	如果$\mathfrak{b}=\bigcup_i \mathfrak{a}_i$，则由包含的命题可知，存在一个$i$使得$\mathfrak{b}\subset \mathfrak{a}_i$. 反过来，$\mathfrak{a}_i\subset \bigcup_i \mathfrak{a}_i=\mathfrak{b}$. 等号的命题得证。

	反证，如果$\mathfrak{b}\subset \bigcup_i \mathfrak{a}_i$但不存在一个$i$使得$\mathfrak{b}\subset \mathfrak{a}_i$. 适当重排顺序，可以假设前$n-2$个理想是素理想。我们采用有限归纳制造矛盾，素理想的假设将会自然地出现。为此，假设$\mathfrak{b}$不能包含于少于$n$个的$\mathfrak{a}_i$的并里面。这就是说，我们能找到$x_i\in \mathfrak{b}$使得$x_i\not\in \bigcup_{j\neq i}\mathfrak{a}_j$，由于$\mathfrak{b}\subset \bigcup_{i=1}^n \mathfrak{a}_i$，所以$x_i\in \mathfrak{a}_i$.

	考虑$x_1+x_2\cdots x_n\in \mathfrak{b}$，如果$\mathfrak{a}_1$是素理想，则$x_2\cdots x_n\not\in \mathfrak{a}_1$，同时由于$x_1\not\in \mathfrak{a}_2$, $\cdots$, $\mathfrak{a}_n$，所以对于任意的$1\leq i \leq n$有$x_1+x_2\cdots x_n\not\in \mathfrak{a}_i$，或者说$x_1+x_2\cdots x_n\not\in \bigcup_{i=1}^n \mathfrak{a}_i$，这与$x_1+x_2\cdots x_n\in \mathfrak{b}$矛盾。

	所以$\mathfrak{b}$必然处于更小的并里面，由反证假设$\mathfrak{b}\not\subset \mathfrak{a}_1$，所以$\mathfrak{b}\subset \bigcup_{i=2}^n \mathfrak{a}_i$. 重复上述论证，假设$\mathfrak{a}_2$是素理想，我们就可以推知$\mathfrak{b}\subset \bigcup_{i=3}^n \mathfrak{a}_i$直到$\mathfrak{b}\subset \mathfrak{a}_n$，这与反证假设矛盾，因此得证。 

	注意到，$x_{n-1}\not\in \mathfrak{a}_n$和$x_{n}\not\in \mathfrak{a}_{n-1}$就足以推出$x_{n-1}+x_{n}\not\in \mathfrak{a}_{n-1}\cup \mathfrak{a}_n$，并不需要素理想的假设，所以命题中才会有至多只有两个不是素理想。
\end{proof}

\begin{pro} \label{primeau}设$\mathfrak{p}$是环$R$的一个素理想，而$\mathfrak{a}_1$, $\cdots$, $\mathfrak{a}_n$是一族理想，如果$\bigcap_i \mathfrak{a}_i\subset \pp$，则存在一个$i$使得$\mathfrak{a_i}\subset \mathfrak{p}$. 如果将包含改成等号，命题依然成立。
\end{pro}

\begin{proof}
	如果$\mathfrak{p}=\bigcap_i \mathfrak{a}_i$，由包含的命题，存在一个$i$使得$\mathfrak{a_i}\subset \mathfrak{p}$. 反过来，$\mathfrak{p}=\bigcap_i \mathfrak{a}_i\subset \mathfrak{a}_i$. 所以我们只要证明包含的命题。假设任取$i$都有$\mathfrak{a}_i\not\subset \mathfrak{p}$，因此存在$x_i\in\mathfrak{a}_i$但$x_i\not\in \mathfrak{p}$. 于是对$x_1\cdots x_n\in \bigcap_{i} \mathfrak{a}_i$，因为$\pp$是素理想，所以$x_1\cdots x_n\not\in \pp$. 矛盾。
\end{proof}

\para 如果对仿射簇理论（见Section \ref{variety}）有所了解，则可以将他们翻译成几何的语言：将理想改成代数集、素理想改成仿射簇、包含改成包含于、并改成交。于是有：
\begin{compactitem}
\item 如果一个代数集包含几个仿射簇的交，则在这些仿射簇中存在一个仿射簇包含于这个代数集中。
\item 如果一个仿射簇包含于几个代数集的并中，则在这些代数集中必然存在一个代数集包含这个仿射簇。
\end{compactitem}

\begin{pro}
设$f:R\to S$是一个环同态，如果$\mathfrak{p}$是$S$中的一个（素）理想，则$f^{-1}(\mathfrak{p})$是一个（素）理想。
\end{pro}

\begin{proof}
	任取$a\in f^{-1}(\mathfrak{p})$以及$r\in R$，由于$f(a)\in \mathfrak{p}$，所以$f(r)f(a)=f(ra)\in \mathfrak{p}$，这也就推出了$ra\in f^{-1}(\mathfrak{p})$. 所以$f^{-1}(\mathfrak{p})$是一个理想。

	设$\pi:S\to S/\mathfrak{p}$是商同态，我们考虑复合映射$\pi\circ f:R\to S/\mathfrak{p}$，由于$f^{-1}(\mathfrak{p})\subset \ker(\pi\circ f)$，所以由商环的泛性质，$\pi\circ f$诱导出了单同态\[R/f^{-1}(\mathfrak{p})\to S/\mathfrak{p},\]
	单性从这里看出：如果$f(r_1)-f(r_2)=\mathfrak{p}$，则$r_1-r_2\in f^{-1}(\mathfrak{p})$. 

	当$\mathfrak{p}$是一个素理想的时候，$S/\mathfrak{p}$是整环，单同态$R/f^{-1}(\mathfrak{p})\to S/\mathfrak{p}$告诉我们$R/f^{-1}(\mathfrak{p})$也是整环，所以$f^{-1}(\mathfrak{p})$也是素理想。
\end{proof}

上面看到了理想的原像一定是一个理想，反过来，一般来说，一个理想的像不一定是一个理想。比如含入同态$\mathbb{Z}\hookrightarrow \mathbb{Q}$下，理想$(2)$的像不是理想。

但是，对于商映射，情况会好很多。

\begin{pro}
设$\pi:R\to R/\mathfrak{a}$是一个商映射，而$\mathfrak{b}$是$R$中的一个理想，则$\bar{\mathfrak{b}}=\pi(\mathfrak{b})$是$R/\mathfrak{a}$中的一个理想。如果$\mathfrak{p}$是包含$\mathfrak{a}$的素理想，则$\bar{\mathfrak{p}}$也是一个素理想。
\end{pro}

\begin{proof}
任取$a\in \mathfrak{b}$，以及$r \in R$，由于$ra\in \mathfrak{b}$，我们也就推出了$\bar{r}\bar{a}=\overline{ra}\in \bar{\mathfrak{b}}$. 所以我们可以考虑这样的商映射$\psi: R/\mathfrak{a}\to (R/\mathfrak{a})/\bar{\mathfrak{b}}$，他与商映射$\pi$复合可以得到满同态
\[
	\psi\pi:R\to (R/\mathfrak{a})/\bar{\mathfrak{b}},
\]
注意到$\psi\pi(r)=0$当且仅当$\bar{r}\in \bar{\mathfrak{b}}$，所以$\ker(\psi\pi)=\pi^{-1}(\bar{\mathfrak{b}})=\mathfrak{a}+\mathfrak{b}$. 由同构基本定理，有同构
\[
	R/(\mathfrak{a}+\mathfrak{b})\cong (R/\mathfrak{a})/\bar{\mathfrak{b}}.
\]
\end{proof}

利用上面这个观察，我们可以对商映射下的理想做出如下断言：$R/\mathfrak{a}$中的（素）理想一一对应着包含$\mathfrak{a}$的（素）理想，通过$\bar{\mathfrak{b}}\to \pi^{-1}(\bar{\mathfrak{b}})$.

\begin{proof} 
	由于$\pi$是一个满射，所以有等式$\pi(\pi^{-1}(\bar{\mathfrak{b}}))=\bar{\mathfrak{b}}$. 剩下我们要证明，如果$\mathfrak{b}\supset \mathfrak{a}$，则$\pi^{-1}(\pi(\mathfrak{b}))=\mathfrak{b}$，而这来自于$\pi^{-1}(\pi(\mathfrak{b}))=\mathfrak{a}+\mathfrak{b}$. 如果$\mathfrak{p}$是包含$\mathfrak{a}$的素理想，则$\mathfrak{a}+\mathfrak{p}=\mathfrak{p}$，上述同构写成$R/\mathfrak{p}\cong (R/\mathfrak{a})/\bar{\mathfrak{p}}$，因此$\bar{\mathfrak{p}}$也是素理想。
\end{proof}

任取环同态$f:R\to S$，我们可以做出如下分解$f:R\to f(R)\hookrightarrow S$，其中满同态$R\to f(R)$的结构我们是清楚的，因为我们可以利用同构$f(R)\cong R/\ker(f)$将它变成商同态$R\to R/\ker(f)$的情况。所以一般而言，含入同态才是造成理想的像不是理想的障碍，正如前面我们举的例子，含入同态$\mathbb{Z}\hookrightarrow \mathbb{Q}$下，理想$(2)$的像不是理想。

\begin{para}
定义一个理想$\mathfrak{a}$的根$\sqrt{\mathfrak{a}}$如下：
\[
	\sqrt{\mathfrak{a}}=\{r\in R\,:\,\exists n\in \mathbb{Z}^+\text{ s.t. }r^n\in \mathfrak{a}\}.
\]
一个理想的根依然是一个理想，检查中困难的是加法，设$a^n\in \aaa$和$b^m\in \aaa$，则$(a+b)^{m+n}$在二项式展开后可以发现，每一项都属于$\aaa$，所以$a+b\in \sqrt{\aaa}$.
\end{para}

一个理想的根其实是所有包含它的素理想的交。实际上，设$A$是所有包含$\mathfrak{a}$的素理想的交，设$\pp$是任意一个包含$\mathfrak{a}$的素理想，如果$f^n\in \mathfrak{a}$，则$f^n\in \pp$，由于$\pp$是素理想，所以$f^n=f\cdot f^{n-1}$给出$f\in\pp$或者$f^{n-1}\in\pp$，通过归纳法就有$f\in \pp$. 这就给出了$\sqrt{\mathfrak{a}}\subset A$. 反过来，如果$f\not\in \sqrt{a}$，考虑所有与$\{1,f,f^2,\cdots\}$不交的，但包含$\mathfrak{a}$的所有理想中极大的那个理想$\pp$，这是一个素理想，存在性来自于Zorn引理，所以$f\not\in \pp$. 这就给出了$A\subset \sqrt{\mathfrak{a}}$.

\section{范畴与函子}

前面看到了，在群/环/模上面，我们都谈论了什么叫同态，什么是同构，以及后来将可能遇到的一些在不同的代数结构上有类似性质的构造。下面我们要引入新的语言来抽象这些东西，他的名字叫范畴。

\para 一个范畴$\mathcal{C}$有如下数据：
\begin{enumerate}
\item 一类(class)对象(object)，类在这里的意思并不是构成一个集合。一个范畴中所有的对象可以不构成一个集合。如果$X$是$\mathcal{C}$的一个对象，我们沿用集合论的符号，写成$X\in \mathcal{C}$.

对每两个对象$X$和$Y$，有一个集合$\mathcal{C}(X,Y)$，有时候也写做$\mathrm{Mor}_{\mathcal{C}}(X,Y)$乃至$\Hom_{\mathcal{C}}(X,Y)$，其中的元素被称为\idx{态射}（\idx{morphism}\footnote{从英文来看，态射构成的集合写作$\mathrm{Mor}_{\mathcal{C}}(X,Y)$比$\Hom_{\mathcal{C}}(X,Y)$准确，因为morphism不一定是homomorphism（同态）。}
）. 设$\varphi\in \mathcal{C}(X,Y)$，他通常沿用映射的记号写成$\varphi:X\to Y$，但态射不必是映射。沿用叫法，$\varphi:X\to Y$中$X$被称为定义域，而$Y$被称为值域。态射还需要满足如下假设：

\begin{itemize}

\item 任取态射$\varphi$，我们可以从他得到唯一的定义域和值域，即$\varphi$如果同时属于$\mathcal{C}(X,Y)$和$\mathcal{C}(Z,W)$，则$X=Z$以及$Y=W$.

\end{itemize}

\item 任取对象$X$, $Y$和$Z\in \mathcal{C}$，则有映射$\mathcal{C}(X,Y)\times \mathcal{C}(Y,Z)\to \mathcal{C}(X,Z)$，沿袭映射的说法，他被称为态射的复合。设$\varphi\in \mathcal{C}(X,Y)$和$\psi \in \mathcal{C}(Y,Z)$，则复合出来的态射被记作$\psi\circ \varphi$或者再简单一点$\psi\varphi$. 复合还需要满足：
\begin{itemize}

\item 态射的复合满足结合率，即$\varphi(\psi\theta)=(\varphi\psi)\theta$.

\item 在每一个$\mathcal{C}(X,X)$中有一个元素$\id_X$使得，任取$\rho:X\to Y$以及$\psi:Z\to X$成立复合$\rho\id_X=\rho$以及$\id_X\psi=\psi$.
\end{itemize}
\end{enumerate}

如果一个范畴的对象可以构成一个集合，那么这个范畴就被称为小范畴。在定义中，我们可以看到，所有对象与集合、态射与映射的相似性，所以我们可以直接断言，所有集合以及集合间的映射构成了一个范畴，他被称为集合范畴，记作$\mathsf{Set}$.

类似地，所有的群/环/$R$-模和他们两两之间的同态构成了一个范畴。左$R$-模范畴我们记作${}_R\mathsf{Mod}$，右$R$-模范畴我们记作$\mathsf{Mod}_R$. 既是左$R$-模，又是右$S$-模的范畴我们记作${}_R\mathsf{Mod}_S$. 下面是一个稍微不一般一点的例子。

从一个范畴也可以构造一些范畴，比如子范畴：一个范畴$\mathcal{C}$的子范畴是一个范畴$\mathcal{S}$，其对象为$\mathcal{C}$内的对象，态射为$\mathcal{C}$内的态射，且有相同的单位态射与态射复合。直观上来看，$\mathcal{C}$的子范畴是一个从C中“移去”部分物件和态射的范畴。比如，模范畴是交换群范畴的子范畴。

\para 设$I$是一个偏序集，偏序关系为$\leq$，那么我们如下定义态射使得他构成了一个范畴：
\[
	\Hom_{I}\left(x,y\right)=\begin{cases}
	\{x,\{x,y\}\}=(x,y)&\text{, if }x\leq y\text{;}\\
	\varnothing&\text{, otherwise}.
	\end{cases}
\]
复合映射就写作$(y,z)(x,y)=(x,z)$，因此偏序集具有一个（小）范畴结构，其中的态射记作$x\leq y$.

一个拓扑空间$X$能被看成一个范畴，对象取作他的所有开集，而态射取作
\[
	\Hom_{X}(U,V)=\begin{cases}
	\bigl\{i^U_V:U\hookrightarrow V\bigr\}&\text{, if }U\subset V\text{;}\\
	\varnothing&\text{, otherwise}.
	\end{cases}
\]
当然这个范畴也可以通过在开集族上给定一个偏序$U\leq V$当且仅当$U\subset V$给出。

所有拓扑空间和其间的连续映射当然构成一个范畴。所有光滑流形和其间的光滑映射构成一个范畴。另外一个例子是关系构成了范畴，他的对象是集合，而$\text{Mor}(X,Y)$是所有$X\times Y$的子集，设$\varphi:X\to Y$和$\psi:Y\to Z$是两个态射，则复合被定义为
\[
	\psi\varphi=\bigl\{(x,z)\in X\times Z\,:\,\exists y\in Y\,\text{ s.t. } (x,y)\in\varphi,\, (y,z)\in \psi\bigr\}.
\]

\para 从一个给定的范畴$\mathcal{C}$，可以构造出一个新的范畴$\mathcal{C}^{\mathrm{op}}$如下：对象不变，定义
\[\mathcal{C}^{\mathrm{op}}(X,Y)=\mathcal{C}(Y,X),\]复合不变。他被称为给定范畴的对偶范畴。凡是纯范畴的命题与证明，将所有态射的箭头全部反过来，可以得到对应的命题与证明，这个原理被称为对偶原理。

对偶范畴的一个实例就是偏序集,他将小于等于改成大于等于。设$(X,\leq)$是一个偏序集，那么$(X,\leq)^\text{op}$与$(X,\leq)$具有相同的对象，但有着相反的态射，即$(X,\leq)^\text{op}$中的偏序$x\leq_{\text{op}} y$当且仅当在$(X,\leq)$中成立$y\leq x$. 对于符号$\leq_{\text{op}}$，我们通常以$\geq$代之，因此，$(X,\leq)$的对偶范畴就是$(X,\geq)$. 如果以$X$代之$(X,\geq)$，则以$X^{\text{op}}$代之$(X,\geq)$.

\para 在范畴论中，我们经常要讨论所谓的交换图。从一个对象$X_0$开始，我们可以通过多次复合不同态射得到一个对象$X_n$，我们可以通过图来表示这个过程，
\[
	X_0\xrightarrow{f_0} X_1\xrightarrow{f_1} X_2\cdots X_{n-1}\xrightarrow{f_{n-1}} X_n.
\]
但一般而言，从$X_0$到$X_n$我们有不同的路径，比如考虑最简单的图
\[
\begin{xy}
	\xymatrix{
		X\ar[r]^{f} \ar[dr]_{h}&Y \ar[d]^{g}\\
		&Z
	}
\end{xy}
\]
从$X$到$Z$一共是两条路径，其一是先通过$Y$然后再到$Z$，另一个是直接到$Z$，前者对应于态射$gf:X\to Z$，后者对应于态射$h:X\to Z$. 称一个图是交换的，就是说沿着不同路径却可以得到相同的结果。比如在上例中就是指$h=gf$. 另一类很常见的图是方的，
\[
\begin{xy}
	\xymatrix{
		A\ar[rr]^{f} \ar[d]_{h}&&B \ar[d]^{g}\\
		C\ar[rr]^{l}&&D
	}
\end{xy}
\]
从$A$到$D$有两条路径，此图交换就是在说$gf=lh$. 

还有，在交换图中，如果出现形如
\[
\begin{xy}
	\xymatrix{
		A\ar@{.>}[r]^{f}&B
	}
\end{xy}
\]
的图，这就意味着，存在唯一的态射$f:A\to B$使得交换图成立。

\para 设$\varphi:X\to Y$和$\psi:Y\to X$，如果$\varphi\psi=\id_Y$和$\psi\varphi=\id_X$，则称对象$X$和$Y$是同构的，$\varphi$或者$\psi$被称为同构（态射）。当然，现在由于暂时不能谈一个态射是单射还是满射，即使可以，也不一定能像模/群/环范畴那样有命题“既单又满的态射是同构”。$X$和$Y$同构记作$X\cong Y$. 集合范畴的同构即双射。

\para 类似于集合之间有映射，范畴之间也有个\idx{函子}(\idx{functor}). 由于范畴有对象以及对象之间的态射，所以函子也是由关于对象和范畴的数据构成的，设$\mathcal{C}$和$\mathcal{D}$是两个范畴，$F$被称为一个函子，如果
\begin{enumerate}
	\item 对任意的$X\in \mathcal{C}$，有唯一的$F(X)\in \mathcal{D}$.
	
	\item 对任意的$\varphi\in \mathcal{C}(X,Y)$，存在唯一的$F(\varphi)\in  \mathcal{D}(F(X),F(Y))$使得成立复合关系$F(\varphi\psi)=F(\varphi)F(\psi)$以及$F(\id_X)=\id_{F(X)}$.
\end{enumerate}

一般将“从$\mathcal{C}$到$\mathcal{D}$的函子$F$”记作$F:\mathcal{C}\to \mathcal{D}$. 虽然记号相同，但是我们可以通过语境来区分他与态射。

与态射类似，函子也能谈复合，设$f:\mathcal{C}\to \mathcal{D}$和$g:\mathcal{D}\to \mathcal{E}$是两个函子，则他们的复合函子$gf:\mathcal{C}\to \mathcal{E}$表现在对象上是$X\mapsto f(X)\mapsto g(f(X))$，表现在态射上是$\varphi\mapsto f(\varphi)\mapsto g(f(\varphi))$. 

函子的实例是非常多的，比如从$R$-模范畴到交换群范畴就有一个函子，他将一个模看成一个交换群，模同态看成交换群同态。这样的函子，从某个结构丰富的范畴到结构没那么丰富的范畴，被称为遗忘函子。遗忘函子又比如从拓扑空间范畴到集合范畴。

再比如，设$X$和$Y$是两个偏序集，则函子$f:X\to Y$是一个映射，且满足对$x_1\leq x_2$成立$f(x_1)\leq f(x_2)$. 这就是偏序集之间的保序映射。

范畴与函子在数学中的出现是如此地频繁的原因在于：对一个数学结构的认识，不仅仅需要描述对象本身，也需要描述这个对象与其他对象之间的作用，即还需要描述态射，这就构成范畴的内容。而函子的出现在于联系两个数学结构，比如我们经常从一些对象开始构造得到新的对象。同样，描述两个合适的数学结构之间的联系，一方面描述对象之间的联系，另一方面也要描述态射之间的联系，而这正是函子所做的。基于这些理由，一个合适的分类理论，不仅仅要分类对象，也要分类态射。

在有些作者那里，上面定义的函子被称为协变函子，而函子$f:\mathcal{C}^{\mathrm{op}} \to \mathcal{D}$被称为反变函子。后者明确写出来即$f(\varphi\psi)=f(\psi)f(\varphi)$，其中$\psi$和$\varphi$都是$\mathcal{C}$中的态射。于是，偏序集之间的反变函子就是逆序映射，对$x_1\leq x_2$成立$f(x_2)\leq f(x_1)$.

\para （反变）态射函子是（反变）函子的重要例子。设$\mathcal{C}$是一个范畴，$A\in \mathcal{C}$是一个对象。定义一个函子$\mathcal{C}(A,\star):\mathcal{C}\to \mathsf{Set}$如下：对于对象，$B\mapsto \mathcal{C}(A,B)$，对于态射$f:B\to C$，它得到了态射
\[
	\mathcal{C}(A,f)=f_*: g\mapsto f\circ g.
\]
此时$\mathcal{C}(A,\star)$被称为关于$A$的\idx{态射函子}。经常，我们将$\mathcal{C}(A,\star)$简单记$h^A$.

同样，我们可以定义\idx{反变态射函子}$\mathcal{C}(\star,A):\mathcal{C}^{\text{op}}\to \mathsf{Set}$：对于对象，$B\mapsto \mathcal{C}(B,A)$，对于态射$f:B\to C$，它通过
\[
	\mathcal{C}(f,A)=f^*: g\mapsto g\circ f
\]
得到了态射$\mathcal{C}(f,A):\mathcal{C}(C,A)\to \mathcal{C}(B,A)$. 经常，我们将$\mathcal{C}(\star,A)$简单记$h_A$，而且有时候会将$h_A(B)$就写做$A(B)$.

\para 由于经常一个构造会涉及两个对象或多个对象，而分别改变对象就会产生不同的函子，为了抽象这个过程，就产生了下面积范畴的概念，正如讨论多元函数引入了集合的直积一样。

设$\mathcal{C}$和$\mathcal{D}$是范畴，他们的积范畴记作$\mathcal{C}\times\mathcal{D}$：对象是这样的二元组$(X,Y)$或$X\times Y$，其中$X\in \mathcal{C}$, $Y\in\mathcal{D}$. 而态射定义为$(\varphi,\psi)$或$\varphi\times \psi$，其中$\varphi$是$\mathcal{C}$中的态射，而$\psi$是$\mathcal{D}$中的态射，这样就建立了集合的等同
\[
	{\mathcal{C}}(X,X')\times {\mathcal{D}}(Y,Y')=(\mathcal{C}\times \mathcal{D})(X\times Y,X'\times Y').
\]
复合定义为$(\varphi,\psi)(\varphi',\psi')=(\varphi\varphi',\psi\psi')$. 在这个复合下，对象$X\times Y$到自己的恒等态射就是$(\id_X,\id_Y)$. 所以$\mathcal{C}\times\mathcal{D}$确确实实是一个范畴。同理，可以定义有限个范畴的积。

设$\mathcal{F}$是另一个范畴，函子$f:\mathcal{C}\times \mathcal{D}\to \mathcal{F}$被称为一个双函子。比如$\mathcal{C}(\star,\star)$是一个$\mathcal{C}^\text{op}\times \mathcal{C}\to \mathsf{Set}$的双函子。如果固定双函子的一个变元，那么双函子会退化成一个函子。比如$\mathcal{C}(\star,\star)$固定第一个变元为$X$的时候得到$h^X$.

反过来，如果$f$对每一个$X\in \mathcal{C}$是函子$f(X,\star):\mathcal{D}\to \mathcal{F}$，以及对每一个$Y\in \mathcal{C}$是函子$f(\star,Y):\mathcal{C}\to \mathcal{F}$，那么何时$f$才是一个双函子。考虑如下图
\[
\begin{xy}
	\xymatrix{
		f(X,Y)\ar[rr]^{f(\varphi,Y)} \ar[d]_{f(X,\psi)}&&f(X',Y) \ar[d]^{f(X',\psi)}\\
		f(X,Y')\ar[rr]^{f(\varphi,Y')}&&f(X',Y')
	}
\end{xy}
\]
如果这个图交换，那么从左上到右下的映射，即复合$f(X,\psi)f(\varphi,Y)$将定义出一个态射$f(\varphi,\psi)$，此时$f$构成一个双函子。具体的检验交由读者。

\para \label{digf}有了二元积范畴，类似地，可以定义多元（有限）积范畴。类似于对角函数，可以定义对角函子：设$\mathcal{C}$是一个范畴，而$\mathcal{C}\times \cdots \times \mathcal{C}$是积范畴。那么可以定义函子$\Delta:\mathcal{C}\to \mathcal{C}\times \cdots \times \mathcal{C}$，对于对象$X$，定义$\Delta:X\mapsto (X$, $\cdots$, $X)$，对于态射$\varphi\in \mathcal{C}(X,Y)$，定义$\Delta: \varphi \mapsto (\varphi$, $\cdots$, $\varphi)$.

甚至是考虑关于一个集合的积范畴（即指标构成一个集合的情况），积范畴依然可以定义。但是如果比如考虑指标并不是一个集合，有些东西就会可能会出现问题。这个问题有相当深刻的背景，涉及了现代数学的逻辑基础，即公理化体系（主要是ZFC公理体系）上面。众所周知，在朴素的集合论里面有Russell悖论，这就限制了一些集合的构造，比如所有集合构成的一个整体并不是集合。到了范畴论里面，我们自然也会面临集合论的问题，比如在我们的定义中，两个对象之间态射的全体需要构成一个集合。如果我们考虑了一族（不能构成集合）的范畴的积范畴，那么这个积范畴的态射集是否就会出问题？

为了避免谈及ZFC公理体系的问题，Grothendieck引入了一个新的假设，即Grothendieck universe的存在。简单来说，就是给出了一个足够大的集合$\mathscr{U}$，而我们在具体问题中谈论的集合，都是$\mathscr{U}$的子集与元素。并且在$\mathscr{U}$内，他的元素与子集在ZFC体系下进行运算都会落入$\mathscr{U}$内。于是在Grothendieck universe内，我们就模拟了一个集合论公理体系，在这里面讨论，就可以避免许多集合论的问题。而所有可能的问题都会集中到Grothendieck universe的存在上。

\para 设$f$和$g$都是从$\mathcal{C}$到$\mathcal{D}$的函子，如果对每一个$X\in \mathcal{C}$都有一个态射$\varphi(X):f(X)\to g(X)$使得如下交换图成立
\[
\begin{xy}
	\xymatrix{
		f(X)\ar[rr]^{\varphi(X)} \ar[d]_{f(\varphi)}&&g(X) \ar[d]^{g(\varphi)}\\
		f(Y)\ar[rr]^{\varphi(Y)}&&g(Y)
	}
\end{xy}
\]
则$\varphi$被称为一个自然变换。自然变换的复合是清楚的。任取函子$f$，也很清楚有恒等自然变换$\id_f:f\to f$，满足$\id_f(X)=\id_{f(X)}$.

自然变换以前叫做函子间的态射。因为如果$\mathcal{C}$是一个小范畴，所有从$\mathcal{C}$到$\mathcal{D}$的函子以自然变换为态射，则它构成了一个范畴，记作$[\mathcal{C},\mathcal{D}]$. 特别地，将$[\mathcal{C}^\text{op},\mathsf{Set}]$记作$\hat{\mathcal{C}}$. 但就像我们前面看到的，如果$\mathcal{C}$不是一个小范畴，则$[\mathcal{C},\mathcal{D}]$可能并不是一个范畴，因为它们的态射集可能太多了。不过，如果我们不去研究$[\mathcal{C},\mathcal{D}]$的具体结构，而止于形式地应用语言，我们还是可以将其看成一个“范畴”。

既然有了函子间“态射”，函子的同构意义也是清楚的了。设$f$和$g$是两个函子，如果存在自然变换$\varphi:f\to g$和$\psi:g\to f$满足$\varphi\psi=\id_g$和$\psi\varphi=\id_f$，则称$f$和$g$同构，记作$f\cong g$.

描述自然变换是范畴论的初衷，自然变换在数学中的频繁出现才使得人们想要抽象出这个概念，为了描述这个概念，人们发明了范畴与函子。自然变换频繁出现的原因在于一些构造：设有一个范畴$\mathcal{C}$，对每一个对象$X\in \mathcal{C}$构造了一个函子$f_X$，比如前面定义出的反变态射函子$h_X$. 当我们改变对象的时候，即给出一个态射$\varphi:X\to Y$，往往具体的构造将诱导出对每一个$V\in \mathcal{C}$都有态射$f_\varphi(V):f_X(V)\to f_Y(V)$. 由于是函子，对态射$\rho:V\to W$也诱导了态射，汇总起来就是有图
\[
\begin{xy}
	\xymatrix{
		f_X(V)\ar[rr]^{f_\varphi(V)} \ar[d]_{f_X(\rho)}&&f_Y(V) \ar[d]^{f_Y(\rho)}\\
		f_X(W)\ar[rr]^{f_\varphi(W)}&&f_Y(W)
	}
\end{xy}
\]
既然有图，要求交换当然是自然的。到了具体例子，图的交换性需要检验。

以反变态射函子为例。给定态射$\varphi:X\to Y$，则$\varphi_*$将给出一个自然变换$h_X\to h_Y$，实际上给定态射$\psi:W\to V$，需要检查图
\[
\begin{xy}
	\xymatrix{
		h_X(V)\ar[rr]^{\varphi_*} \ar[d]_{\psi^*}&&h_Y(V) \ar[d]^{\psi^*}\\
		h_X(W)\ar[rr]^{\varphi_*}&&h_Y(W)
	}
\end{xy}
\]
任取$\pi\in h_X(V)$即$\pi:V\to X$，有$\psi^*(\varphi_*(\pi))=\varphi\pi\psi$以及$\varphi_*(\psi^*(\pi))=\varphi\pi\psi$，所以图是交换的。类似例子给出如下命题：如果$X\cong Y$，则$h_X\cong h_Y$. 反命题实际上也是正确的，后面会予以证明。

\para 设$f$, $g:\mathcal{C}\to \mathcal{D}$是函子，$X\in \mathcal{C}$是一个对象，通过$X:f\to f(X)$以及任取自然变换$\varphi:f\to g$，定义$X(\varphi)=\varphi(X):f(X)\to g(X)$，可以看到此时$X$此时构成一个$[\mathcal{C},\mathcal{D}] \to \mathcal{D}$的函子。可见，$f(X)$一方面可以将$f$理解成函子，另一方面也可以将$X$理解成函子。只不过前者是范畴$\mathcal{C}$到范畴$\mathcal{D}$的函子，后者是范畴$[\mathcal{C},\mathcal{D}]$到范畴$\mathcal{D}$的函子。将这点抽象出来，如果把$f(X)$写作$\Gamma(X,f)$，则
\[
	\Gamma(\star,\star):\mathcal{C}\times [\mathcal{C},\mathcal{D}]\to \mathcal{D}
\]
是一个双函子。这点的证明只要按定义应用上面的判据就可以了。

\para 双函子之间的“态射”，表现为如下自然变换
\[
\begin{xy}
	\xymatrix{
		f(X,Y)\ar[rr]^{\varphi(X,Y)} \ar[d]_{f(\psi,\varphi)}&&g(X,Y) \ar[d]^{g(\psi,\varphi)}\\
		f(X',Y')\ar[rr]^{\varphi(X',Y')}&&g(X',Y')
	}
\end{xy}
\]
很清楚，当固定$X$的时候，$\varphi(X,\star)$是$f(X,\star)\to g(X,\star)$的一个自然变换。固定$Y$也一样。

反过来，设$f$, $g:\mathcal{C}\times \mathcal{D}\to \mathcal{F}$是两个双函子，如果任取$X\in \mathcal{C}$，存在自然变换$\alpha(X):f(X,\star)\to g(X,\star)$，任取$Y\in \mathcal{D}$，存在自然变换使得$\beta(Y):f(\star,Y)\to g(\star,Y)$，且$\alpha(X)(Y)=\beta(Y)(X)$，则存在自然变换$\gamma:f\to g$使得$\gamma(X,Y)=\alpha(X)(Y)=\beta(Y)(X)$.

\begin{proof}
	考虑态射$(\psi,\varphi):(X,Y)\to (X',Y')$，他可以拆成
	\[
		(\psi,\varphi): (X,Y) \xrightarrow{(\psi,\id_Y)} (X',Y)\xrightarrow{(\id_{X'},\varphi)} (X',Y'),
	\]
	分别应用自由变换
	\[
	\begin{xy}
		\xymatrix{
			f(X,Y)\ar[rr]^{\alpha(X)(Y)} \ar[d]_{f(\psi,\id_Y)}&&g(X,Y) \ar[d]^{g(\psi,\id_Y)}\\
			f(X',Y)\ar[rr]^{\alpha(X')(Y)}_{\beta(Y)(X')} \ar[d]_{f(\id_{X'},\varphi)}&&g(X',Y) \ar[d]^{g(\id_{X'},\varphi)}\\
			f(X',Y')\ar[rr]^{\beta(Y')(X')}&&g(X',Y')
		}
	\end{xy}
	\]
	因此，从左上到右下两条路给出$g(\psi,\varphi)\alpha(X)(Y)=\beta(Y')(X')f(\psi,\varphi)$，由于$\gamma(X,Y)=\alpha(X)(Y)=\beta(Y)(X)$，所以也就是$g(\psi,\varphi)\gamma(X,Y)=\gamma(X',Y')f(\psi,\varphi)$，所以$\gamma:f\to g$是一个自然变换。
\end{proof}

% \lem Yoneda引理：设$\mathcal{C}$是一个范畴，$A\in \mathcal{C}$是一个对象，$F:\mathcal{C}\to \mathsf{Set}$是一个函子，则从$\mathcal{C}(A,\star)$到函子$F$上的自然变换一一对应着$F(A)$里面的元素。

% \begin{proof} 对每个自然变换$\alpha:\Hom_\mathcal{C}(A,\star)\to F$定义$\theta(\alpha)=\alpha(A)(\id_A)\in F(A)$，现在定义一个逆映射即可。对$x\in F(A)$，定义自然变换$\psi(x):\Hom_\mathcal{C}(A,\star)\to F$通过$\psi(x)(B)(f)=F(f)(x)$，不难验证这是一个自然变换，而且$\psi$和$\theta$是互逆的。\end{proof}

\para 下面我们要引入可表函子，在具体给出定义之前先做出如下观察：设$X\in\mathsf{Set}$是一个集合，那么它与集合$X(e)={\mathsf{Set}}(e,X)$之间存在一个双射，其中$e$是任意的一个单点集。但事实上，在任意范畴$\mathcal{C}$，类似于集合范畴中的单点集的东西是不一定存在的，所以我们转而同时考虑所有的${\mathcal{C}}(Y,X)$，其中$Y\in \mathcal{C}$，或者说考虑反变态射函子$h_X$，此时我们可以得到对象$X\in \mathcal{C}$足够多乃至于全部的信息，这就类似于物理中测量的思想，人类进行的一切测量都是通过相互作用完成的，并且通过测量得到了被测物的信息。事实上，如果$h_X\cong h_Y$，则$X\cong Y$. 这点会在后面得到证明。

设$f$是一个$\mathcal{C}$到$\mathsf{Set}$的反变函子，如果$f\cong h_X$对某个$X\in \mathcal{C}$成立，一方面，我们可以用函子$f$来描述$X$，另一方面，我们也可以拿$X$来描述函子$f$. 为此，我们做出如下定义：如果反变函子$f:\mathcal{C}^{\text{op}}\to \mathsf{Set}$同构于一个反变态射函子$h_X$，则$f$被称为可表函子，以及此时$f$被$X$表示，$X$是$f$的表示对象。

可表函子的出现是频繁的，因为实际上，在范畴论中，我们时常想要构造一个与其他对象“有着某某性质的态射”的对象，而这些“某某性质的态射”往往是事先已知的（比如从一个已知函子和已知范畴映过来的）. 比方说，我们已经有了一个函子$f:\mathcal{C}^\text{op}\to\mathsf{Set}$，它用来描述那些事先给定了的“某某性质的态射”，如果$f$是可表的，则$f\cong h_X$，则这些事先给定的态射就是$h_X(Y)=\mathcal{C}(Y,X)$，而这里的表示对象$X$就是我们试图构造的对象。

这里给一个直接的例子，设$\mathcal{C}$, $\mathcal{D}$是两个范畴，而$f:\mathcal{C}\to \mathcal{D}$是一个函子，对给定的$Y$，$\mathcal{D}(f(-),Y)$就是一个从$\mathcal{C}$到$\mathsf{Set}$的反变函子。它描述了所有形如$f(X)$的对象与$Y$之间的态射，如果它可表，表示对象为$g(Y)$，则我们就有同构$\mathcal{C}(-,g(Y))\cong \mathcal{D}(f(-),Y)$. 这也就意味着，我们只需要研究所有形如$X\to g(Y)$的态射即可。

对偶地，如果$f$是一个$\mathcal{C}$到$\mathsf{Set}$的函子，我们称$f$是可表的，如果它同构于$h^X$，此时$X$被称为$f$的表示对象。

\begin{lem}
对任意的$X\in \mathcal{C}$以及$f\in \hat{\mathcal{C}}$，存在同构$i_{X,f}:\Gamma(X,f)=f(X)\to {\hat{\mathcal{C}}}(h_X,f)$.
\end{lem}

\begin{proof}
	固定$f$，任取自然变换$\varphi\in {\hat{\mathcal{C}}}(h_X,f)$，对象$Y\in\mathcal{C}$以及态射$g:Y\to X$，有交换图
	\[
	\begin{xy}
		\xymatrix{
			h_X(X)\ar[rr]^{\varphi(X)} \ar[d]_{g^*}&&f(X) \ar[d]^{f(g)}\\
			h_X(Y)\ar[rr]^{\varphi(Y)}&&f(Y)
		}
	\end{xy}
	\]
	取$\id_X\in h_X(X)=\mathcal{C}(X,X)$，有$e_{X,f}(\varphi)=\varphi(X)(\id_X)\in f(X)$，因此有映射$e_{X,f}:{\hat{\mathcal{C}}}(h_X,f)\to f(X)$. 由交换图，$\varphi(Y)(g)=f(g)\left(e_{X,f}(\varphi)\right)$.

	反过来任取$a\in f(X)$，对每一个$Y\in\mathcal{C}$，我们可以定义映射
	\[
	\begin{array}{ccccc}
	i(a)(Y)&:&h_X(Y)&\to &f(Y)\\
	i(a)(Y)&:&g&\mapsto&f(g)(a)
	\end{array},
	\]
	这样也就定义了一个函子$i_{X,f}(a)\in {\hat{\mathcal{C}}}(h_X,f)$，继而有映射$i_{X,f}:f(X)\to {\hat{\mathcal{C}}}(h_X,f)$. 最后只要检验$e_{X,f}(i_{X,f}(a))=a$以及$i_{X,f}(e_{X,f}(\varphi))=\varphi$，他们都由$i_{X,f}(Y)(g)=f(g)\left(e_{X,f}(\varphi)\right)$保证。
\end{proof}

对偶地，设$f$是一个$\mathcal{C}$到集合范畴的函子，则$\Gamma(X,f)\cong [\mathcal{C},\mathsf{Set}](h^X,f)$对任意的$X\in \mathcal{C}$都成立。

% \para 对于固定的$X$，他可以看成一个$\hat{\mathcal{C}}=[\mathcal{C}^\text{op},\mathsf{Set}]\to \mathsf{Set}$的函子。同样，对于固定的$X$，态射函子${\hat{\mathcal{C}}}(h_X,\star)$也是一个$\hat{\mathcal{C}}\to \mathsf{Set}$的函子。上面的引理就是在说，这两个函子作用在相同的对象$f\in \hat{\mathcal{C}}$上可以得到同构的两个对象。

% 对于固定的$f$，他本身是$\hat{\mathcal{C}}$中的函子，也可以写成$\Gamma(\star,f)$. 同时，函子${\hat{\mathcal{C}}}(h_\star,f):\mathcal{C}^{\text{op}}\to \mathsf{Set}$也是$\hat{\mathcal{C}}$中的函子。上面的引理就是在说，这两个函子作用在相同的对象$X\in \mathcal{C}$上可以得到同构的两个对象。

% 下面一个命题告诉我们，Lemma (\thepara)中的同构对于这两对函子都是自然变换，即实际上是函子间的同构，而不仅仅是作用在对象上的同构。

% 如果有一个自然变换$\varphi:f\to g$，他将诱导出态射$\varphi(X):f(X)\to g(X)$，以及态射$\varphi_*: {\hat{\mathcal{C}}}(h_X,f)\to {\hat{\mathcal{C}}}(h_X,g)$.

\para 固定$X$，${\hat{\mathcal{C}}}(h_X,\star)$是一个函子。固定$f$，${\hat{\mathcal{C}}}(h_\star,f)$也是一个函子。为了检查${\hat{\mathcal{C}}}(h_\star,\star)$是一个双函子，必须检查图
\[
\begin{xy}
	\xymatrix{
		\hat{\mathcal{C}}(h_{X},f)\ar[rr]^{\hat{\mathcal{C}}(\varphi^*,f)} \ar[d]_{\psi_*}&&\hat{\mathcal{C}}(h_{X'},f) \ar[d]^{\psi_*}\\
		\hat{\mathcal{C}}(h_{X},f')\ar[rr]^{\hat{\mathcal{C}}(\varphi^*,f')}&&\hat{\mathcal{C}}(h_{X'},f')
	}
\end{xy}
\]
其中$\varphi:X'\to X$是一个态射，而$\psi:f\to f'$是一个自然变换。任取$\pi\in \hat{\mathcal{C}}(h_{X},f)$，则先右再下得到$\psi_*(\varphi^*(\pi))=\psi\pi\varphi$. 先下再右得到$\varphi_*(\psi^*(\pi))=\psi\pi\varphi$. 所以图交换，因此${\hat{\mathcal{C}}}(h_\star,\star)$是一个双函子。

\begin{pro}
上面的引理可以加强到双函子同构：$i_{-,\star}:\Gamma(-,\star)\to {\hat{\mathcal{C}}}(h_-,\star)$，这被称为Yoneda引理。
\end{pro}

\begin{proof}
	由于同构已经有了构造，所以只要检验是不是自然变换。而这点只要分别固定$X$和$f$去证明即可。

	固定$X$，给出$\varphi:f\to g$，检验交换图
	\[
	\begin{xy}
		\xymatrix{
			f(X)\ar@<0.3ex>[rr]^-{i_{X,f}} \ar[d]_{\varphi(X)}&&{\hat{\mathcal{C}}}(h_X,f) \ar[d]^{\varphi_*}\ar@<0.3ex>[ll]^-{e_{X,f}}\\
			g(X)\ar@<0.3ex>[rr]^-{i_{X,g}}&&{\hat{\mathcal{C}}}(h_X,g)\ar@<0.3ex>[ll]^-{e_{X,g}}
		}
	\end{xy}
	\]
	固定$f$，给出$\varphi:Y\to X$，检验交换图
	\[
	\begin{xy}
		\xymatrix{
			f(X)\ar@<0.3ex>[rr]^-{i_{X,f}} \ar[d]_{f(\varphi)}&&{\hat{\mathcal{C}}}(h_X,f) \ar[d]^{(\varphi^*)^*}\ar@<0.3ex>[ll]^-{e_{X,f}}\\
			f(Y)\ar@<0.3ex>[rr]^-{i_{Y,f}}&&{\hat{\mathcal{C}}}(h_Y,f)\ar@<0.3ex>[ll]^-{e_{Y,f}}
		}
	\end{xy}
	\]
	构造都是清楚的，检查都是直接的。
	
	仅仅以第一个交换图里面的一部分为例，任取$a\in f(X)$，检查$\varphi\circ (i_f(a))=i_g\bigl(\varphi(X)(a)\bigr)\in {\hat{\mathcal{C}}}(h_X,g)$. 给一个$Y\in \mathcal{C}$，$i_g\bigl(\varphi(X)(a)\bigr)(Y):p\mapsto g(p)\bigl (\varphi(X)(a)\bigr)$，其中$p:Y\to X$是一个态射。同样，$\varphi\circ (i_f(a))(Y)=\varphi\bigl(p\mapsto f(p)(a)\bigr):p\mapsto \varphi(Y)\bigl(f(p)(a)\bigr)$. 最后只要检验$g(p)\bigl (\varphi(X)(a)\bigr)=\varphi(Y)\bigl(f(p)(a)\bigr)$，注意到交换图
	\[
	\begin{xy}
		\xymatrix{
			f(X)\ar[rr]^{\varphi(X)} \ar[d]_{f(p)}&&g(X) \ar[d]^{g(p)}\\
			f(Y)\ar[rr]^{\varphi(Y)}&&g(Y)
		}
	\end{xy}
	\]
	所以得证，其他的检查也类似。
\end{proof}

\begin{pro}
对偶地，存在双函子同构$i_{-,\star}:\Gamma(-,\star)\to [\mathcal{C},\mathsf{Set}](h^-,\star)$，这也被称为Yoneda引理。
\end{pro}

在Yoneda引理的证明中，已经看到，最不平凡的地方在于：如果函子$\mathcal{C}(-,X)$与函子$\mathcal{C}(-,X')$同构，则$X\cong X'$. 类似地，还有协变的版本，如果函子$\mathcal{C}(X,-)$与函子$\mathcal{C}(X',-)$同构，则$X\cong X'$. 所以，往往这两点被单独拎出来称为Yoneda引理。

\para 特别地，当$f=h_Y$，则$h_Y\cong {\hat{\mathcal{C}}}(h_\star,h_Y)$. 作用到$X$上得到$h_Y(X)={\mathcal{C}}(X,Y)\cong {\hat{\mathcal{C}}}(h_X,h_Y)$. 所以，$X\cong Y$当且仅当$h_X\cong h_Y$. 如果$f$是可表函子，$X$和$Y$同时表示了函子$f$，则同构$h_X\cong f \cong h_Y$诱导了同构$X\cong Y$，因此可表函子的表示对象确定到一个同构。 

\para 设$\mathcal{C}$是一个范畴，则$\id_\mathcal{C}:\mathcal{C}\to \mathcal{C}$是恒等函子，他使得$\id_\mathcal{C}(X)=X$，以及$\id_\mathcal{C}(\varphi)=\varphi$. 如果一个函子$f:\mathcal{C}\to\mathcal{C}$与恒等函子同构，即有如下交换图成立
\[
\begin{xy}
	\xymatrix{
		X\ar@<0.3ex>[rr]^-{p(X)} \ar[d]_{\varphi}&&f(X) \ar[d]^{f(\varphi)}\ar@<0.3ex>[ll]^-{q(X)}\\
		Y\ar@<0.3ex>[rr]^-{p(Y)}&&f(Y)\ar@<0.3ex>[ll]^-{q(Y)}
	}
\end{xy}
\]
那么在范畴论意义下，我们无法区分范畴$\mathcal{C}$和范畴$f(\mathcal{C})$，因为这两个范畴有相同的结构。尽管，原本$X\in \mathcal{C}$在$f(\mathcal{C})$里面变成了$f(X)$，看上去变成了不同的对象，但这仅仅类似于重命名，对范畴的结构并没有任何影响。所以如果谈论范畴的等价，也应该止步于此，即有相同结构的范畴看成是等价的。

设$\mathcal{C}$和$\mathcal{D}$是两个范畴，而$f:\mathcal{C}\to \mathcal{D}$以及$g:\mathcal{D}\to \mathcal{C}$是两个函子，那么如果$gf\cong \id_\mathcal{C}$以及$fg\cong \id_\mathcal{D}$，则称这两个范畴等价。

这个定义并不好用，不过他有另一种表述。但是需要引入两个新的定义：称呼函子$f:\mathcal{C}\to \mathcal{D}$是忠实函子/完全函子，如果$f:\mathcal{C}(X,Y)\to \mathcal{D}\bigl(f(X),f(Y)\bigr)$是集合间的单射/满射。

\begin{pro}\label{equivcat}
两个范畴$\mathcal{C}$和$\mathcal{D}$是等价范畴，当且仅当存在一个即忠实又完全的函子$f:\mathcal{C}\to \mathcal{D}$使得任取$Y\in\mathcal{D}$都有一个$X\in \mathcal{C}$使得$f(X)$与$Y$同构。
\end{pro}

\begin{proof}
假设$f:\mathcal{C}\to \mathcal{D}$和$g:\mathcal{C}\to \mathcal{D}$是范畴之间的等价函子，即满足$gf\cong \id_\mathcal{C}$以及$fg\cong \id_\mathcal{D}$. 所以，任取$Y$，我们都可以找到$g(Y)\in\mathcal{C}$使得$f(g(Y))$同构于$Y$.

现在对映射$\varphi\in \mathcal{C}(X,X')$，我们考虑映射
\[
	\id_{\mathcal{C}(X,X')}:\varphi\mapsto f(\varphi) \mapsto g(f(\varphi)) \mapsto \varphi,
\]
最后一个映射来自于$gf\cong \id_\mathcal{C}$给出的交换图
\[
\begin{xy}
	\xymatrix{
		X\ar@<0.3ex>[rr]^-{p(X)} \ar[d]_{\varphi}&&g(f(X)) \ar[d]^{g(f(\varphi))}\ar@<0.3ex>[ll]^-{q(X)}\\
		X'\ar@<0.3ex>[rr]^-{p(X')}&&g(f(X'))\ar@<0.3ex>[ll]^-{q(X')}
	}
\end{xy}
\]
即$\varphi=q(X') \circ g(f(\varphi))\circ p(X)$. 所以$\varphi\mapsto f(\varphi)$是一个从$\mathcal{C}(X,X')$到$\mathcal{D}(f(X),f(X'))$的单射，所以$f$是一个忠实函子。

同时，$f(\varphi) \mapsto g(f(\varphi)) \mapsto \varphi$是一个满射，由于$g(f(\varphi)) \mapsto \varphi$是一一的，所以我们得到了$\mathcal{D}(f(X),f(X'))$到$\mathcal{C}(g(f(X)),g(f(X'))$的满射。现在任取$Y$和$Y'$，从上可知，我们能找到与之同构的$f(X)$和$f(X')$，所以我们也就得到了$\mathcal{D}(Y,Y')$到$\mathcal{C}(g(Y),g(Y'))$的满射。因此$g$是一个完全函子。类似地考察$fg\cong \id_\mathcal{D}$，我们可以知道$f$是一个完全函子，而$g$是一个忠实函子。

反过来，设存在一个即忠实又完全的函子$f:\mathcal{C}\to \mathcal{D}$使得任取$Y\in\mathcal{D}$都有一个$X\in \mathcal{C}$使得$f(X)$与$Y$同构。于是，对每一个$Y\in \mathcal{D}$，找一个$X_Y$使得$f(X_Y)$与$Y$同构，同构映射为$p(Y):f(X_Y)\to Y$. 现在，我们定义一个函子$g:\mathcal{D}\to \mathcal{C}$，通过令$g(Y)=X_Y$，对态射$\psi:Y\to Y'$，令
\[
	g(\psi)=f^{-1}\left(p(Y')^{-1}\circ \psi \circ p(Y)\right)\in \mathcal{C}(g(Y),g(Y')),
\]
其中同构$f^{-1}:\mathcal{D}(f(g(Y)),f(g(Y')))\to \mathcal{C}(g(Y),g(Y'))$来自于忠实且完全函子$f$. $g$显然是一个函子。

最后，我们可以定义自然变换$p$：通过令$p(Y):f(g(Y))\to Y$. 此时，考虑图
\[
\begin{xy}
	\xymatrix{
		Y\ar[rr]^-{p(Y)} \ar[d]_{\psi}&&f(g(Y)) \ar[d]^{f(g(\psi))}\\
		Y'\ar[rr]^-{p(Y')}&&f(g(Y'))
	}
\end{xy}
\]
从$g(\psi)$的定义，可以看到上图交换，所以$p$确实是一个自然变换。类似地，$p^{-1}$也是一个自然变换，它们分别给出了函子同构$fg\cong \id_\mathcal{D}$以及$gf\cong \id_\mathcal{C}$.
\end{proof}

本节的最后，我们谈论单射和满射在范畴中的对应。

\begin{para}
一个态射被称为左可消的，或者叫\idx{单态}（\idx{monomorphism}），任取$g_1$和$g_2$，如果$fg_1=fg_2$，则$g_1=g_2$. 对偶地，称一个态射是右可消的，或者叫\idx{满态}（\idx{epimorphism}），任取$g_1$和$g_2$，如果$g_1f=g_2f$，则$g_1=g_2$. 显然，两个单态复合还是单态，两个满态复合还是满态。
\end{para}

单态和满态是模范畴单同态以及满同态的推广，在模范畴中，可以看到这与单同态以及满同态是等价的概念。实际上，如果$f:M\to N$是单同态，则$fg_1(x)=fg_2(x)$可以推出$f(g_1(x)-g_2(x))=0$进而$g_1=g_2$. 反过来，如果$f$不是单同态，选$g_1:\ker f\hookrightarrow M$以及$g_2=0:\ker f\to M$，可以看到$fg_1=fg_2=0$成立，但是$g_1\neq g_2$. 类似地，在模范畴，$f$是满同态当且仅当他是满态。但是在一般的范畴中，这种等价是不一定成立的。

这点比方考虑所有Hausdorff空间构成的范畴$\mathsf{Haus}$，其中的态射是连续映射。其中的单态都是单射，但是其中的满态是那些连续映射$f:X\to Y$满足$f(X)$在$Y$中稠密，所以并不需要是一个满射。

\section{极限与余极限}

\para 在很久以前，我们在有限积范畴上定义了所谓的对角函子。在这节，我们需要拓展这个概念。设$\mathcal{J}$是一个小范畴，$\mathcal{C}$是一个范畴，我们如下定义函子$\Delta:\mathcal{C}\to [\mathcal{J},\mathcal{C}]$：
\begin{itemize}
\item 任取$X$和$j\in \mathcal{J}$以及$\mathcal{J}$中的态射$\varphi$，我们定义$\Delta(X)(j)=X$且$\Delta(X)(\varphi)=\id_X$.
\item 对态射$\psi:X\to Y$，态射$\Delta\psi:\Delta(X)\to \Delta(Y)$这里应是一个自然变换，任取$j\in \mathcal{J}$，我们定义$\Delta\psi(j)=\psi$，它们都将$\Delta(X)(j)=X$映射成$\Delta(Y)(j)=Y$.
\end{itemize}

\para 设$I$是一个小范畴（即范畴对象的全体能够构成一个集合），我们称函子$D:I\to \mathcal{C}$为$\mathcal{C}$中的一个$I$-图，或者简略叫做图。对于$i\in I$，$D(i)$称为该图的一个顶点（经常改用下标写作$D_i$），而对任意的态射$\alpha_{ij}:i\to j$，态射$D(\alpha_{ij})$称为该图的一条边。

作为例子，当$I$是一个指标集，即不同的$i$, $j\in I$之间不存在态射时，一个$I$-图就是一族以$I$为指标集的对象。此外，给定小范畴$I$及任取$X\in \mathcal{C}$，$\Delta X$就是一个$I$-图。

\para 这里考虑$I$-图之间的自然变换（因为它们是函子）。设$I$是一个小范畴，$\mathcal{C}$是一个范畴，而$D:I\to \mathcal{C}$是$\mathcal{C}$上的一个$I$-图。

给定$X\in\mathcal{C}$，现在考虑$\varphi\in [I,\mathcal{C}](\Delta X,D)$，它可以表为如下的交换图
\[
	\xymatrix{
		X\ar@{=}[rr]\ar[d]_{\varphi(i)}&&X\ar[d]^{\varphi(j)}\\
		D(i)\ar[rr]^-{D(\alpha_{ij})}&&D(j)
	}
\]
其中$i$, $j\in I$以及$\alpha_{ij}:i\to j$任意。通常，我们会把交换图画成
\[
	\xymatrix{
		&X\ar[dl]_{\varphi(i)}\ar[dr]^{\varphi(j)}&\\
		D(i)\ar[rr]^-{D(\alpha_{ij})}&&D(j)
	}
\]
此时，自然变换$\varphi$被称为$I$-图$D$的一个以$X$为顶点的\idx{锥形}。

\para 设$I$是一个小范畴，$\mathcal{C}$是一个范畴，而$D:I\to \mathcal{C}$是$\mathcal{C}$上的一个$I$-图。现在考虑反变函子
\[
	X\mapsto [I,\mathcal{C}](\Delta X,D):\mathcal{C}^{\text{op}}\to \mathsf{Set},
\]
如果他是可表的，则称$I$-图$D$存在极限，其表示对象记作${\varprojlim}_{i\in I} D(i)$，他被称为$I$-图$D$的\idx{极限}。从表示函子的知识可知，如果极限存在，则它在同构意义上唯一。

现在，我们来考察可表条件。为方便起见，我们记$A={\varprojlim}_{i\in I} D(i)$. 可表条件就是说存在同构$\lambda:h_{A}\to [I,\mathcal{C}](\Delta -,D)$. 具体到$X$，即存在同构
\[
	\lambda(X):\mathcal{C}\left(X,{\varprojlim}_{i\in I} D(i)\right)\to [I,\mathcal{C}](\Delta X,D).
\]
他就是在说，任取映射$f:X\to {\varprojlim}_{i\in I} D(i)$，都存在一个锥形$\mu=\lambda(X)(f):\Delta X\to D$. 反之亦然，因此，我们可以用如下的泛性质来表述这个事实：
\[
	\xymatrix{
		&&D(i)\ar[dd]^{D(\alpha_{ij})}\\
		X\ar@{.>}[r]|-{f}\ar@/^/[rru]^-{\mu(i)}\ar@/_/[rrd]_{\mu(j)}&{\varprojlim}_{i\in I} D(i)\ar[ru]\ar[rd]&\\
		&&D(j)
	}
\]
图中略去的箭头是极限自带的态射族，即锥形$\lambda(A)(\id_A)$，虚线代表唯一存在（来自于态射族之间的同构）。

可以看到，如果$I$-图$D$的极限$A$存在，我们都有一个固有的锥形$\lambda(A)(\id_A)$. 通常地，我们会将这个锥形定义成极限，并且，将锥形$\mu$记作$(A,\mu)$的形式，其中$A$是顶点。此时，极限可以定义为：设$(A,\lambda)$是一个锥形，如果对于任意的锥形$(X,\mu)$，都存在唯一的态射$f:X\to A$使得如下分解$\mu(j):X\xrightarrow{f}A\xrightarrow{\lambda(j)}D(i)$成立，则锥形$\lambda$被称为$I$-图$D$的极限。这个定义的直观化即上面的交换图。

作为例子，一族集合的直积是一个极限。设$\{X_i\,:\, i\in I\}$是一族集合，它的直积记作$\prod_{i\in I}X_i$，且到每个分量都有一个投影函数$\pi_i:\prod_{i\in I}X_i\to X_i$. 这两个数据构成了这一族集合的极限。

\begin{para}
锥形和极限都有对偶的概念，在交换图中，无外乎就是将箭头完全反过来。余极限定义为函子
\[
	X\mapsto [I,\mathcal{C}](D,\Delta X):\mathcal{C}\to \mathsf{Set}
\]
的表示对象。对$\lambda\in [I,\mathcal{C}](D,\Delta X)$，他是一个形如
\[
	\xymatrix{
		&X&\\
		D(i)\ar[rr]^-{D(\alpha_{ij})}\ar[ur]^{\varphi(i)}&&D(j)\ar[ul]_{\varphi(j)}
	}
\]
的交换图，他被称为$I$-图的一个\idx{余锥形}，类似锥形，我们会特别写出其顶点$X$，将其记作$(X,\lambda)$.

称呼一个余锥形$(A,\lambda)$是$I$-图的一个{余极限}，如果对于任意的余锥形$(B,\mu)$，都存在唯一的态射$f:A\to B$使得如下分解$\mu(j):D(i)\xrightarrow{\lambda(j)}A\xrightarrow{f}B$成立。一般将$I$-图$D$的余极限写作${\varinjlim}_{i\in I} D(i)$. 类似极限，如果余极限存在，则它在同构意义上唯一。
\end{para}

\begin{pro}\label{homlimit}
设$\mathcal{C}$是一个范畴，而$I$是一个小范畴，再设$X:i\mapsto X_i$是一个$I$-图，如果极限与余极限存在，则有自然同构
\[
	{\varprojlim} \mathcal{C}(-,X_i)\cong \mathcal{C}\left(-,{\varprojlim} X_i\right),\quad {\varprojlim} \mathcal{C}(X_i,-)\cong  \mathcal{C}\left({\varinjlim} X_i,-\right)
\]
其中极限与余极限都是对$I$-图进行的。
\end{pro}

\begin{proof}
	仅证第一点，第二点是类似的。从极限的定义，我们知道
	\[
	\mathcal{C}\left(-,{\varprojlim}_i X_i\right)\cong [I,\mathcal{C}](\Delta -,X),
	\]
	所以只要证明
	\[
	[I,\mathcal{C}](\Delta -,X)\cong {\varprojlim}_i \mathcal{C}(-,X_i).
	\]

	给定$Y$. 我们下面构造同构$\alpha(Y):[I,\mathcal{C}](\Delta Y,X)\to {\varprojlim}_i \mathcal{C}(Y,X_i)$. 首先任取锥形$(Y,\mu)\in [I,\mathcal{C}](\Delta Y,X)$，以及集合范畴里面的一个单元素集$\{*\}$，定义映射$h(i):*\mapsto \mu(i)$，于是我们就有了映射$h(i):\{*\}\to \mathcal{C}(Y,X_i)$，不难验证，它构成了一个锥形
	\[
		\xymatrix{
			&\{*\} \ar[dl]_{h(i)}\ar[dr]^{h(j)}&\\
			\mathcal{C}(Y,X_i)\ar[rr]^{X(\alpha_{ij})_*}&&\mathcal{C}(Y,X_j)
		}
	\]
	因为$X(\alpha_{ij})_*(h(i))(*)=X(\alpha_{ij})\circ h(i)(*)=X(\alpha_{ij})\circ \mu(i)=\mu(j)=h(j)(*)$.

	由${\varprojlim}_i \mathcal{C}(Y,X_i)$的泛性质，我们可以知道，从$\{*\}$到${\varprojlim}_i \mathcal{C}(Y,X_i)$有唯一的映射$h_\mu$，使得分解
	\[
	h(i):\{*\}\xrightarrow{h_\mu} {\varprojlim}_i \mathcal{C}(Y,X_i) \xrightarrow{p(i)} \mathcal{C}(Y,X_i)
	\]
	成立，其中$p(i)$是极限自带的映射。现在我们定义$\alpha(Y)(\mu)=h_\mu(*)$.

	现在我们来直接构造$\alpha(Y)$的逆映射$\beta(Y):{\varprojlim}_i \mathcal{C}(Y,X_i)\to [I,\mathcal{C}](\Delta Y,X)$. 任取$a\in {\varprojlim}_i \mathcal{C}(Y,X_i)$，设$p(i):{\varprojlim}_i \mathcal{C}(Y,X_i)\to \mathcal{C}(Y,X_i)$是极限自带的映射，则$p(i)(a)\in \mathcal{C}(Y,X_i)$. 由于$X(\alpha_{ij})\circ (p(i)(a))=p(j)(a)$，所以我们有锥形
	\[
		\xymatrix{
			&Y \ar[dl]_{p(i)(a)}\ar[dr]^{p(j)(a)}&\\
			X_i\ar[rr]^{X(\alpha_{ij})}&&X_j
		}
	\]
	记这个锥形为$\mu_a$，我们定义$\beta(Y)(a)=\mu_a$.

	不难验证$\alpha(Y)(\mu_a)=a$. 实际上$\mu_a(i)=p(i)(a)$，因此$h(i)(*)=p(i)(a)$. 定义$h_{\mu_a}(*)=a$，则分解
	\[
	h(i):\{*\}\xrightarrow{h_{\mu_a}} {\varprojlim}_i \mathcal{C}(Y,X_i) \to \mathcal{C}(Y,X_i)
	\]
	成立。由$h_{\mu_a}$的唯一性，我们知道$\alpha(Y)(\mu_a)=a$. 反过来，不难验证$\beta(Y)(h_\mu(*))=\mu$. 实际上，令$\beta(Y)(h_\mu(*))=\lambda$，则$\lambda(i)=p(i)(h_\mu(*))=h(i)(*)=\mu(i)$. 所以$\lambda=\mu$. 综上，$\alpha(Y)$和$\beta(Y)$互逆。

	最后，可以直接检验$\alpha(Y)$和$\beta(Y)$是自然变换。
\end{proof}

极限很好地抽象了许多有用的概念，我们列一些在下面。

\begin{para}[终对象与始对象]
没有对象以及态射的范畴，我们记作$\varnothing$. 考虑任意范畴$\mathcal{C}$，$\mathcal{C}$中$\varnothing$-图的极限就是所谓的\idx{终对象}. 对偶地，有\idx{始对象}。由极限的唯一性，可知一个范畴中终对象和始对象在同构意义下是唯一的。

如果用泛性质来表述：若$X\in \mathcal{C}$满足任意的$Y\in \mathcal{C}$都有唯一的态射$Y\to X$，则称$X$是一个终对象。反过来，如果任取$Y\in \mathcal{C}$都有唯一的态射$X\to Y$，则称$X$是一个始对象。

如果一个对象即是始对象又是终对象，则称它是一个零对象。零对象往往会记作$0$，从零对象出发或者到零对象的唯一态射也会被记作$0$.

始对象和终对象是不一定存在的，比如在域构成的范畴中，没有始对象与终对象。在集合范畴，始对象是任意单点集，而终对象是空集。在左$R$-模范畴中，零模$0$是零对象。
\end{para}

\begin{para}[积与余积]
设$I$是一个集合，如果附加上所有的恒等态射，则$I$构成一个范畴。考虑任意范畴$\mathcal{C}$，此时$\mathcal{C}$中$I$-图的极限就是所谓的\idx{积}. 对偶地，有\idx{余积}。由极限的唯一性，可知一个范畴中积和余积在同构意义下是唯一的。如果$I$是一个空集，则积变成终对象，而余积变成始对象。

考虑一个$I$-图$D$，$D(i)=D_i\in \mathcal{C}$，此时积往往记作$\prod_{i\in I} D_i$，对应着还有投影态射$p_i:\prod_{i\in I} D_i\to D_i$. 它可以用泛性质重新表示如下：设$X$是$\mathcal{C}$中的一个对象，他到每一个$D_i$都有一个态射$f_i$，则存在唯一的态射$f:X\to \prod_{i\in I} D_i$使得分解$p_if=f_i$对$i\in I$都成立。余积的泛性质也类似。

显然，集合的直积是一个积。

如果$I$是一个$n$元素集，则称$I$-图的极限为$n$元积。它们统称为有限积。有限积记作$X_1\times \cdots \times X_n$的形式。显然，存在二元积，就存在任意的有限积，为此，只需要检查$X_1\times (X_2\times (X_3 \times \cdots (X_{n-1}\times X_n)))$满足泛性质即可。
\end{para}

\begin{para}[等值子与余等值子]
考虑$\mathcal{J}$是这样一个范畴，它有两个对象，除了自己到自己的恒等态射外，两个对象之间还有同向的两个态射，我们记作$\xymatrix{\cdot\ar@<0.3ex>[r] \ar@<-0.3ex>[r]&\cdot}$. 设$D:\mathcal{J}\to\mathcal{C}$是一个协变函子，他将两个态射变为$f$, $g:X\to Y$，于是在$\mathcal{C}$中关于$J$-图$D$的极限就是对象$\eq(f,g)$以及态射$i:\eq(f,g)\to X$，满足：$fi=gi$，任取对象$A\in \mathcal{C}$以及态射$p:A\to X$使得$fp=gp$，则存在唯一的态射$h:A\to \eq(f,g)$使得下面的交换图成立：
\[
\begin{xy}
	\xymatrix{
		\eq(f,g)\ar[r]^-{i}&X\ar@<0.3ex>[r]^-{f} \ar@<-0.3ex>[r]_-{g}&Y\\
		A\ar@{.>}[u]^-{h}\ar[ur]_-{p}
	}
\end{xy}
\]

集合范畴的等值子很简单，设$f$, $g:X\to Y$是两个映射，则$\eq(f,g)=\{x\in X\,:\, f(x)=g(x)\}$. 不难检验，对于模范畴，$0$可以看成任意两个模之间的同态（比如看作左乘$0$），此时$\ker(f)=\eq(f,0)$. 

对偶地，可以定义余等值子，它使得如下交换图成立
\[
\begin{xy}
	\xymatrix{
		X\ar@<0.3ex>[r]^-{f} \ar@<-0.3ex>[r]_-{g}&Y\ar[r]^-{\pi}\ar[dr]_-{q}&\mathrm{coeq}(f,g)\ar@{.>}[d]^-{h}\\
		&&A
	}
\end{xy}
\]
类似地，在模范畴里面，$\coker(f)=\mathrm{coeq}(f,0)$.
\end{para}

\begin{para}[纤维积]
另一个极限的例子如下。考虑范畴$\mathcal{J}=\cdot \to \cdot \leftarrow \cdot$，即$\mathcal{J}$只有三个对象，除去恒等态射外，剩下的还有两边指向中间的态射。那么$\mathcal{J}$-图$X\xrightarrow{f} Z \xleftarrow{g} Y$的极限$X\times_Z Y$用泛性质表述就是如下交换图
\[
\begin{xy}
	\xymatrix{
		A\ar@/_/[rdd]\ar@/^/[drr]\ar@{.>}[dr]&&\\
		&X\times_Z Y\ar[d]_{\pi_2}\ar[r]_{\pi_1}&X\ar[d]^f\\
		&Y\ar[r]_g&Z
	}
\end{xy}
\]
这样的极限$X\times_Z Y$，被称为$X$, $Y$关于$Z$的\idx{纤维积}，或者叫\idx{拉回}。

如果$X=Y$，则我们回到了等值子的情况。假设$X$, $Y$和$Z$都是集合，不难检验，$X\times_Z Y=\{(x,y)\in X \times Y\,:\,f(x)=g(y)\in Z\}$. 于是若$Z$是单点集，则$X\times_Z Y=X\times Y$，若$X$和$Y$的子集，它们到$Z$都是标准的含入映射，则$X\times_Z Y=X\cap Y$.
\end{para}

下面几个引理试图给出以上几个特殊极限之间的关系。

\begin{lem}
如果范畴$\mathcal{C}$中二元积与等值子总存在，则在该范畴中纤维积也总存在。
\end{lem}

\begin{proof}
考虑$X\xrightarrow{f} Z \xleftarrow{g} Y$, $X\xleftarrow{p_X}X\times Y\xrightarrow{p_Y} Y$. 将$X\times_Z Y$定义为映射$fp_X$, $gp_Y: X\times Y\to Z$的等值子即可。
\end{proof}

\begin{lem}
如果范畴$\mathcal{C}$中纤维积与终对象总存在，当且仅当在该范畴中有限积和等值子总存在。
\end{lem}

\begin{proof}
从右往左从上一个引理是清楚的。现在只需要证从左往右的部分。终对象方便起见我们记作$0$，然后定义$X\times Y=X\times_0 Y$. 有了二元积和终对象，则所有的有限积也都存在了。

最后，考虑$f$, $g:X\to Y$. 连同$\id_X$和$\id_Y$，由积的泛性质，存在唯一的态射$\id_X\times f:X \to X\times Y$以及$\id_X\times g:X \to X\times Y$. 最后，考虑它们的纤维积
\[
\begin{xy}
	\xymatrix{
	X\times_{X\times Y} X\ar[d]_{\pi_2}\ar[r]^-{\pi_1}&X\ar[d]^{\id_X\times f}\\
	X\ar[r]_{\id_X\times g}& X\times Y
	}
\end{xy}
\]
$X\times_{X\times X} Y$即我们所求的等值子。实际上，
\[
	\pi_1=\id_X\pi_1=p_1(\id_X\times f)\pi_1=p_1(\id_X\times g)\pi_2=\pi_2,
\]
\[
	f\pi_1=p_2(\id_X\times f)\pi_1=p_2(\id_X\times g)\pi_2=g\pi_2=g\pi_1.
\]
再由纤维积的泛性质就给出了等值子的泛性质。
\end{proof}

\begin{para}
一个范畴中，如果对象与态射都是有限的，则称这个范畴是有限范畴。有限范畴的图的极限被称为有限极限。如果一个范畴中任意（有限）极限都存在，则称这个范畴是（有限）完备的。
\end{para}

下一个定理告诉我们，只需要积和等值子这俩个特殊的极限存在，则任意极限都存在。

\begin{thm}\label{wanbei}
设$\mathcal{C}$是一个范畴，则以下命题等价：
\begin{compactenum}[~~~~(1)]
\item $\mathcal{C}$是（有限）完备的。
\item $\mathcal{C}$中的（有限）积与等值子总存在。
\end{compactenum}
\end{thm}

在有限完备的情况下，第二点可以替换为存在任意纤维积与终对象。

\begin{para}
对偶地，有限范畴的图的极限被称为有限余极限。如果一个范畴中任意（有限）余极限都存在，则称这个范畴是（有限）余完备的。
\end{para}

\begin{thm}\label{yuwanbei}
设$\mathcal{C}$是一个范畴，则以下命题等价：
\begin{compactenum}[~~~~(1)]
\item $\mathcal{C}$是（有限）余完备的。
\item $\mathcal{C}$中的（有限）余积与余等值子总存在。
\end{compactenum}
\end{thm}

\section{准加性范畴}

\begin{para}
设$\mathcal{C}$是一个范畴，如果函子$\mathcal{C}(-,*)$是一个从$\mathcal{C}^\text{op}\times \mathcal{C}$到交换群范畴$\mathsf{Ab}$的函子，则称范畴$\mathcal{C}$是一个准加性范畴，有些时候也叫做$\mathsf{Ab}$-范畴。模范畴显然是一个准加性范畴。
\end{para}

对于准加性范畴$\mathcal{C}$，$\mathcal{C}(X,Y)$是一个交换群，交换群的运算我们一如既往写作加法。这就意味着，在$\mathcal{C}(X,Y)$中至少存在一个零元，我们称为零态射，统统记作$0$. 注意，此时$0$的定义域和值域需要看语境确定。

同时，任取$f:Y_1\to Y_2$，则$\mathcal{C}(X,f):\mathcal{C}(X,Y_1)\to \mathcal{C}(X,Y_2)$是一个交换群同态。因此，$f(g+h)=fg+fh$. 同理，右复合也满足这样的“分配律”。应用到零元上，我们有$f0=0$以及$0f=0$.

注意，虽然这里的零态射总是似乎在暗示我们存在一个零对象，可事实并非如此。考虑域的范畴，他显然是一个准加性范畴，但却没有零对象。

\begin{pro}\label{zeroobj}
准加性范畴中，以下命题等价：
\begin{compactenum}[~~~(1)]
\item $A$是一个始对象。
\item $\mathcal{C}(A,A)$是单点集。
\item $A$是一个终对象。
\item $A$是一个零对象。
\end{compactenum}
\end{pro}

\begin{proof}
我们一旦证明了(1)和(3)等价，则(4)是自然的。所以只要证明(1)和(3)都和(2)等价即可。

设$A$是始对象或者是终对象，则$\mathcal{C}(A,A)$是单点集. 反过来，假设$\mathcal{C}(A,A)$是单点集，所以$\id_A=0$，考虑$f\in \mathcal{C}(A,X)$，由于$f=f\id_A=f0=0$. 所以$A$是始对象。考虑$f\in \mathcal{C}(X,A)$，由于$f=\id_A f=0f=0$. 所以$A$是终对象。
\end{proof}

如果准加性范畴$\mathcal{C}$中有一个零对象$0$，则对任意的$X$, $Y\in\mathcal{C}$，我们都有唯一的态射$0': X\to 0 \to Y$. 上述命题也顺便告诉我们$0=0'$. 

\begin{para}
在准加性范畴$\mathcal{C}$中，定义$\ker(f)=\eq(f,0)$以及$\coker(f)=\mathrm{coeq}(f,0)$. 注意到，作为极限或者余极限，实际上，除了对象外，还有一个态射。比如，对$f:M\to N$有一个态射$\pi_f:N\to \coker(f)$，这是构成余核的一个资料。再比如，对于$\ker f$，就有一个态射$i_f:\ker f\to M$. 

作为例子，设$0:X\to Y$是零态射，通过直接验证泛性质，可知$\ker(0)=X$以及$i_0=\id_X$.
\end{para}

\begin{para}
在准加性范畴$\mathcal{C}$中，如果任意核都存在，则任意等值子都存在。实际上，$f$, $g$的等值子就是$\ker(f-g)$. 同理，如果任意余核存在，则任意余等值子存在。所以，在准加性范畴$\mathcal{C}$中，（余）核的存在等价于（余）等值子的存在。
\end{para}

当谈论两个核是同构的时候，不应只认为存在同构$\varphi:\ker(f)_1\to \ker(f)_2$，还应把极限包含的态射拿进来一起看，即满足如下交换图
\[
\begin{xy}
	\xymatrix{
	\ker(f)_1\ar[d]_{\varphi}\ar[r]^-{i_1} &X\\
	\ker(f)_2\ar[ru]_{i_2}
	}
\end{xy}
\]
余核也是类似的。

所以，经常我们会直接将$\ker f$看成一个态射，谈及对象的时候，只要取其定义域即可，也经常同样记作$\ker f$. $\coker f$同理。

\begin{para}

为了更清楚地描述指向同一个对象的态射或从同一对象出发的态射的同构，我们做出如下定义：

\begin{itemize}
\item 设$f$和$g$指向同一个对象，若此时存在一个态射$\varphi$使得交换图成立
\[
\begin{xy}
	\xymatrix{
	\cdot\ar[r]^-{f} &\cdot\\
	\cdot \ar[u]^{\varphi}\ar[ru]_{g}
	}
\end{xy}
\]
则记$g\leq f$. 

\item  设$u$和$v$都从同一个对象出发，若此时存在一个态射$\varphi$使得交换图成立
\[
\begin{xy}
	\xymatrix{
	\cdot \ar[r]^-{u}\ar[rd]_{v} &\cdot \\
	&\cdot \ar[u]_{\varphi}
	}
\end{xy}
\]
则记$u\geq v$. 
\end{itemize}

不难检验$\leq$和$\geq$是自反的以及可传递的，但却不满足$f\leq g$且$g\leq f$可推出$f=g$. 所以它们并不是偏序关系。如果$f\leq g$且$g\leq f$，则记$f\approx g$. 同样，如果$u\geq v$且$v\geq u$，记$u\approx v$.

当然，这两个关系是属于不同集合的。将所有指向$X$的态射集合记作$P^X$，即集合$\mathcal{C}(-,X)$. 将所有从$Y$出发的态射集合记作$Q_Y$，即集合$\mathcal{C}(Y,-)$. 很容易验证（在保证存在性的时候），$\coker : P^X \to Q_X$，而$\ker : Q_X\to P^X$.
\end{para}

作为例子之一，如果$\ker(f)_1$和$\ker(f)_2$都是一个态射$f$的核，则$\ker(f)_1\approx\ker(f)_2$. 

作为例子之二，如果$fg=0$，由$\ker f$的泛性质，我们有唯一的分解$g=\ker(f)g'$，此时$g\leq \ker f$. 类似地，如果$gf=0$，由$\coker f$的泛性质，我们有唯一的分解$g=g'\coker(f)$，此时$g\geq \coker f$. 简而言之，
\[
	g\leq \ker f \quad \Leftrightarrow \quad fg=0\quad  \Leftrightarrow \quad f\geq \coker g.
\]

\begin{para}
在定义$\leq$和$\geq$的时候，只需要分解的存在性。有时候，泛性质还能告诉我们唯一性。实际上，当$\ker$出现在$\leq$右边的时候，即比如$g\leq \ker(f)$，泛性质说明了分解$g=\ker(f)g'$是唯一的。对偶地，当$\coker$出现在$\geq$右边的时候，即比如$f\geq \coker(g)$，则分解$g=g'\coker(f)$是唯一的。
\end{para}

因此，如果两个态射$f$, $g$满足$\ker f\approx \ker g$，则$\ker f$和$\ker g$实际是同构的。但因为，在选定核的时候，本来就允许一个同构的存在，所以此时写作$\ker f=\ker g$也完全没有问题。

\begin{pro}\label{glgl}假设所有的核与余核都存在，则如下命题成立：
\begin{compactenum}[~~~(1)]
\item 如果$f\geq g$，则$\ker g \leq \ker f$. 
\item 对偶地，如果$u\leq v$，则$\coker v \geq \coker u$. 
\item $f\leq \ker(\coker f)$.
\item 对偶地，$u\geq \coker(\ker u)$.
\end{compactenum}
\end{pro}

该命题给出了$P^X$和$Q_X$之间的一个“Galois联络”（见附录），当然，它不是真的Galois联络，因为$\geq$和$\leq$都不是真的偏序。但是，类似地，我们可以断言
\[
	\ker f\approx \ker \coker \ker f,\quad \coker u \approx \coker \ker \coker u.
\]
当然，因为在选定核（余核）的时候，本来就允许一个同构的存在，所以上式也可以写作
\begin{equation}\label{kck}
\ker f= \ker \coker \ker f,\quad \coker u = \coker \ker \coker u.
\end{equation}
因此，如果$g$是一个核，当且仅当它满足$g=\ker \coker g$. 对偶地，如果$v$是一个余核，当且仅当它满足$v = \coker \ker v$.

\begin{proof}一条一条证明。
\begin{compactenum}[~~~(1)]
\item 由于$f\geq g$，所以$f=g'g$，由恒等式$g\ker(g)=0$，我们得到了$f\ker(g)=g'g\ker(g)=0$，即$\ker g\leq \ker f$. 
\item 对偶原理保证了这点。
\item 考虑如下交换图
\[
\begin{xy}
	\xymatrix{
	\cdot \ar[rr]^-{\ker \coker f}&&\cdot \ar@<0.3ex>[r]^-{\coker f} \ar@<-0.3ex>[r]_-{0}&\cdot \\
	\cdot \ar@{.>}[u]\ar[urr]_f
	}
\end{xy}
\]
其中虚线来自于$\ker$的泛性质，所以定义给出了$f\leq \ker(\coker f)$.
\item 对偶原理保证了这点。
\end{compactenum}
\end{proof}

作为推论，如果$f\approx g$都从同一个对象出发，则$\ker f\approx \ker g$. 同样，如果$u\approx v$都指向同一个对象，则$\coker u \approx \coker v$.

\begin{para}[复合态射的核与余核]
显然$f$和$gf$的起点是相同的，且$gf\geq f$. 所以上面的命题告诉我们，$\ker f \leq \ker (gf)$. 同样，$g$和$gf$的终点是相同的，且$gf\leq g$，所以$\coker(g) \geq \coker(gf)$.
\end{para}

在准加性范畴中，核（余核）与单态（满态）联系密切。

\begin{lem}
设$\mathcal{C}$是一个准加性范畴，而$f:X\to Y$是其中的一个态射，如果$\ker f$存在，则它是一个单态。对偶地，如果$\coker f$存在，则它是一个满态。
\end{lem}

\begin{proof}
对偶的论断是对偶原理保证的。任取$g_1$, $g_2:Z\to \ker(f)$，对$\ker (f) g_1=\ker (f) g_2=k:Z\to X$，由$\ker$的泛性质，存在唯一的态射$g:Z\to \ker(f)$使得分解$\ker (f) g_1=\ker (f) g_2=\ker (f) g$成立。由分解的唯一性，则$g_1=g=g_2$.
\end{proof}

% \begin{lem}
% 设$\mathcal{C}$是一个准加性范畴，且存在零对象$0$. 如果$0:X\to Y$是一个单态，则$X=0$. 如果$0:X\to Y$是一个满态，则$Y=0$.
% \end{lem}

% \begin{proof}
% 由$0\id_X =00=0$，单态的左可消性保证了第一点。由$\id_Y 0=00=0$，满态的右可消性保证了第二点。
% \end{proof}

\begin{para}
类比熟知的$\coker f$的定义$N/\im f$，可以定义$\im f=\ker \coker f$. 对偶地，可以定义$\coim f=\coker \ker f$.
\end{para}

为使得这个定义是良定的，我们需要证明选取不同的$\coker f$，我们将得到同构的$\im f$. 为此，如果选取不同的$(\coker f)_1$和$(\coker f)_2$，有$(\coker f)_1\approx (\coker f)_2$. Proposition \ref{glgl}的推论告诉我们，$\ker (\coker f)_1\approx \ker (\coker f)_2$. 此即所需。

此外，任取态射$f$. 我们都可以保证$f$成立唯一分解$f=\im(f)q$. 事实上，由于$\coker(f)f=0$，由$\ker$的泛性质，我们就得到$f=\ker(\coker f)q$.

\begin{pro}
设$\mathcal{C}$是一个准加性范畴，如果$\mathcal{C}$中含有零对象$0$，则
\begin{compactenum}[~~~(1)]
\item $f:X\to Y$是一个单态当且仅当$\ker f=0$.
\item $f:X\to Y$是一个满态当且仅当$\coker f=0$.
\end{compactenum}
\end{pro}

\begin{proof}
只证第一个，第二个是类似的。如果$f:X\to Y$是一个单态，考虑任意的$fg=0$，由于$f$是单态，所以$fg=0=f0$给出了$g=0$. 由此，不难检验$0$满足核的泛性质。反过来，如果$\ker(f)=0$. 假设$fg_1=fg_2$或等价的$fh=f(g_1-g_2)=0$，其中$h=g_1-g_2$. 由于$\ker(f)=0$，由核的泛性质，存在唯一的态射$k$使得分解$h=0k$成立，于是$h=0$.
\end{proof}

\begin{pro}
设$\mathcal{C}$是一个准加性范畴，而$X_1$, $X_2\in \mathcal{C}$，则$X_1$和$X_2$的积与余积等价。此时记$X_1$和$X_2$的积（余积）为$X_1\oplus X_2$，他有四个典范映射：作为积的投影$p_1:X_1\oplus X_2\to X_1$, $p_2:X_1\oplus X_2\to X_2$和作为余积的含入$i_1:X_1\to X_1\oplus X_2$, $i_2:X_2\to X_1\oplus X_2$. 满足
\[
	p_ai_a=\id_{X_a},\quad i_1p_1+i_2p_2=\id_{X_1\oplus X_2},\quad p_ai_b=0,
\]
其中$\{a$, $b\}=\{1$, $2\}$. 
\end{pro}

反过来，如果具有一个对象$X_1\oplus X_2$和满足上述关系的四个典范映射，则我们称它们构成了$X_1$和$X_2$的一个双积。一个双积不难检验是一个积，实际上，如果有$f_a:Y\to X_a$，则构造$f_1\times f_2=i_1f_1+i_2f_2$，他就是满足积的泛性质的唯一分解。同理，不难检验这是一个余积，实际上，如果有$g_a:X_a\to Y$，则构造$g=g_1p_1+g_2p_2$，他就是满足余积的泛性质的唯一分解。

结合上面的命题，我们得到了：准加性范畴中，二元积等价于二元余积等价于双积。

\begin{proof}
从前面的一些简单的推理，显然，我们只需要构造双积即可。

设$X_1\times X_2$是$X_1$和$X_2$的积，具有投影$p_1:X_1\times X_2\to X_1$, $p_2:X_1\times X_2\to X_2$. 考虑$\id_{X_1}:X_1\to X_1$和$0:X_1\to X_2$，由积的泛性质，存在唯一的态射$i_1:X_1\times X_2 \to X_1$使得$p_1i_1=\id_{X_1}$, $p_2i_1=0$. 同理，可以得到$i_2:X_1\times X_2 \to X_2$满足$p_2i_2=\id_{X_2}$, $p_1i_2=0$. 最后，考虑$i_1p_1+i_2p_2:X_1\times X_2\to X_1\times X_2$，以及映射
\[
	p_a(i_1p_1+i_2p_2)=p_a:X_1\times X_2\to X_a,
\]
由积的泛性质，存在唯一的态射$\id_{X_1\times X_2}$使得$p_a\id_{X_1\times X_2}=p_a$成立，所以$i_1p_1+i_2p_2=\id_{X_1\times X_2}$.

同理，从$X_1$和$X_2$的余积可以得到积的两个典范态射满足双积的所有条件。
\end{proof}

\begin{para}
既然有了$X_1\oplus X_2$，那么拓展到$X=X_1\oplus \cdots \oplus X_n$也是直接的。如果用泛性质来表示，他有$2n$个典范态射$\{p_a:X\to X_a\}$和$\{i_a:X_a\to X\}$，满足
\[
	p_ai_a=\id_{X_a},\quad \sum_{a=1}^n i_ap_a=\id_{X},\quad p_ai_b=0,
\]
其中$a\neq b$.

通常，我们将$X_1\oplus \cdots \oplus X_n$记作$\bigoplus_{a=1}^nX_a$.
\end{para}

\begin{pro}
设$X=\bigoplus_{a=1}^mX_a$和$Y=\bigoplus_{b=1}^nY_b$，则任意$f:X\to Y$可以由所有的$f_{ab}=p^Y_afi^X_b:X_b\to Y_a$确定。并且，如果有$g:Y\to Z=\bigoplus_{c=1}^lZ_c$，则$(gf)_{ab}=\sum_{c}g_{ac}f_{cb}$.
\end{pro}

如果对矩阵有些了解，不难发现第二点就是矩阵乘法。

\begin{proof}
实际上，
\[
	\sum_{a,b}i^Y_af_{ab}p^X_b=\sum_{a,b}i^Y_ap^Y_afi^X_bp^X_b=\left(\sum_ai^Y_ap^Y_a\right) f\left(\sum_bi^X_bp^X_b\right)=\id_{Y}f\id_{X}=f.
\]
以及
\[
	(gf)_{ab}=p^Z_agfi^X_b=p^Z_ag\id_Y fi^X_b=\sum_c p^Z_ag i^Y_cp^Y_c fi^X_b=\sum_{c}g_{ac}f_{cb}.
\]
\end{proof}

第一点告诉我们，如果存在一族映射$f_{ab}:X_b\to Y_a$，可以构造$f=\sum_{a,b}i^Y_af_{ab}p^X_b:\bigoplus_{a=1}^mX_a\to \bigoplus_{b=1}^nY_b$使得$f_{ab}=p^Y_afi^X_b$成立。特别地，如果只存在那些“对角”的态射$f_a:X_a\to Y_a$，我们可以构造$f_1\oplus \cdots \oplus f_n:\bigoplus_{a=1}^nX_a\to \bigoplus_{a=1}^nY_a$使得
\[
	p^Y_a(f_1\oplus \cdots \oplus f_n)i^X_a=f_a,
\]
其中
\[
	f_1\oplus \cdots \oplus f_n=\sum_{a}i^Y_af_{a}p^X_a.
\]

\begin{para}
如果一个准加性范畴中任意有限积都存在，则称这是一个加性范畴。
\end{para}

注意，终对象也是有限积，所以加性范畴存在零对象。由于准加性范畴中有限积就是有限余积，所以加性范畴中任意有限余积也存在。

\begin{para}
如果在一个加性范畴中，任意的核与余核存在，任意的单态是某个态射的核，任意的满态是某个态射的余核，则称这个范畴是一个Abel范畴。
\end{para}

注意，在准加性范畴中，如果任意的任意的核与余核存在，则任意的等值子与任意的余等值子存在。此外，加性范畴中存在任意的有限积与余有限积。结合这两点，从Theorem \ref{wanbei}和\ref{yuwanbei}可以知道，Abel范畴是有限完备且有限余完备的。

\begin{lem}
设$f$, $g:X\to Y$，如果等值子（看作态射）$\eq(f,g)$是满态，则$\eq(f,g)$是同构。
\end{lem}

\begin{proof}
由于$f\eq(f,g)=g\eq(f,g)$，如果$\eq(f,g)$是满态（右可消），如果$f=g$. 此时不难检验$\id_X$是$f$, $f:X\to Y$的一个等值子，由等值子的泛性质，存在同构$\varphi$使得$\id_X=\eq(f,f)\varphi$. 最后，考虑$\eq(f,f)\varphi\eq(f,f)=\eq(f,f)$，由等值子的泛性质，分解的唯一性保证了$\varphi\eq(f,f)=\id_{\eq(f,f)}$. 因此$\eq(f,f)$是一个同构。
\end{proof}

\begin{pro}
Abel范畴中，一个态射是同构等价于它既是单态又是满态。
\end{pro}

\begin{proof}
设$\varphi$即是单态又是满态，因为是Abel范畴，所以存在$\psi$使得$\varphi=\ker(\psi)$. 从上一个引理，$\ker(\psi)$作为等值子如果是满态则必然是同构。

反过来，假设$\varphi$是同构。它的逆写作$\psi$，如果$\varphi f=\varphi g$，则$\psi\varphi f =\psi\varphi g$给出$f=g$，所以$\varphi$是单态。同理，放在右边可以给出满态。
\end{proof}

已经知道，在加性范畴中，如果$\ker$和$\coker$都存在，则$f$成立唯一分解$f=\im(f)q$. 事实上，由于$\coker(f)f=0$，由$\ker$的泛性质，我们就得到$f=\ker(\coker f)q$.

\begin{lem}\label{lem1}
在Abel范畴中，如果$f$存在分解$f=m'q'$，其中$m'$是一个核，那么存在唯一的单态$t$使得下面的交换图成立
\[
\begin{xy}
	\xymatrix{
	\cdot \ar[r]^q\ar[d]_{q'}& \cdot \ar[d]^{\im f}\ar@{.>}[dl]^t\\
	\cdot \ar[r]_{m'}& \cdot 
	}
\end{xy}
\]
且$q$是一个满态。
\end{lem}

\begin{proof}
设$m'=\ker s$以及$p'=\coker m'$，由恒等式$\ker s=\ker \coker \ker s$（见式\eqref{kck}），因此$m'=\ker p'$. 同样，取$p=\coker \im f=\coker \ker \coker f=\coker f$. 

由于$p'f=p'm'q'=\coker(m')m'q'=0$，由$p=\coker f$的泛性质，存在唯一分解$p'=wp$. 由$p'\im f=wp\im f=w (\coker f) \ker(\coker f)=0$以及$m'=\ker p'$的泛性质，存在唯一分解$\im f=m' t$. 此外，$m' q'=m'tq$，由于$m'=\ker p'$是单态，所以$q'=tq$. 因此，交换图成立。并且，由于$\im f=m't$，所以$t$是一个单态。

下面证明$q$是一个满态。设$rq=0$，由$\ker r$的泛性质，存在唯一分解$q=\ker (r) q'$. 于是$f=\im(f)q=\im(f)\ker (r) q'=m'q'$，因为$m'=\im(f)\ker (r)$作为单态的复合是一个单态，在Abel范畴中是一个核，所以由上面的已知的结论，存在唯一的$t$使得$\im f=m't=\im(f)\ker (r) t$. 由于$\im f$是单态，所以$\id =\ker (r) t$. 由于$\id$是满态，所以$\ker (r)$是满态。实际上，如果$x\ker(r)=y\ker(r)$，则$x=x\ker (r) t=y\ker (r) t=y$. 此时，$r\ker r=0$给出$r=0$. 

综上，由$rq=0$可推出$r=0$，所以$q$是一个满态。
\end{proof}

\begin{pro}\label{uni}
在Abel范畴中，$f=\im(f)\coim(f)$. 而且，如果$f=gh$，其中$g$是单态而$h$是满态，则存在同构$t$使得$g=\im(f)t$以及$\coim(f)=th$.
\end{pro}

\begin{proof}
首先，$f$成立唯一分解$f=\im(f)q$. 所以，$ft=0$等价于$\im(f)qt=0$，由于$\im$是一个$\ker$所以是单态，$ft=0$又等价于$qt=0$. 因此$\ker f= \ker q$. 由于$q$是一个满态，所以是一个$\coker$，写成$q=\coker s$. 由恒等式$\coker s = \coker \ker \coker s$，所以$q=\coker \ker q=\coker \ker f=\coim f$. 

唯一性的部分命题直接来自于上面的引理。从上一个引理，我们知道存在这样的单态$t$. 由于$\coim(f)=th$，左侧是一个满态，所以$t$是一个满态。一个单态如果是满态，则必然是一个同构。
\end{proof}

\begin{pro}
在Abel范畴中，$\ker f=0$当且仅当$f=\im f$. 对偶地，$\coker f=0$当且仅当$f=\coim f$. 
\end{pro}

\begin{proof}
实际上，如果$\ker f=0$，即$f$是单态。此时$t=0$等价于$ft=0$等价于$\im (f) \coim(f)t=0$等价于$\coim(f)t=0$，所以$\coim(f)$是一个单态，也因此是一个同构。由于$\im$的定义本来就容许一个同构的存在，所以写成$f=\im f$也没什么。

对偶地，如果$\coker f=0$，即$f$是一个满态。此时$t=0$等价于$tf=0$等价于$t\im (f) \coim(f)=0$等价于$t\im(f)=0$，所以$\im(f)$是一个满态，也因此是一个同构。由于$\coim$的定义本来就容许一个同构的存在，所以可以写成$f=\coim f$.
\end{proof}

本节的最后，我们证明一个很有用的命题，他将用在上同调的定义中。

\begin{pro}
在Abel范畴中，态射$f$, $g$满足$gf=0$. 现考虑如下交换图
\[
\begin{xy}
	\xymatrix{
	&&\cdot \ar[rrd]^b&&\\
	\cdot \ar[rr]^f \ar[rrd]_a&&\cdot \ar[rr]^g\ar[u]^{\coker f}&&\cdot\\
	&&\cdot \ar[u]_{\ker g}&&
	}
\end{xy}
\]
其中$a$, $b$是核与余核的泛性质诱导的态射。记$\coker(a)$指向$[\coker(a)]$，以及$\ker(b)$的起点为$[\ker(b)]$. 则存在一个同构$t:[\coker(a)]\to [\ker(b)]$.
\end{pro}

\begin{proof}
首先，我们假设$f$是一个单态，而$g$是一个满态。令$\varphi=\coker (f) \ker (g)$，我们验证$a=\ker \varphi$和$b=\coker \varphi$，即验证它们满足泛性质。

设$\varphi \theta=\coker (f)\ker(g)\theta=0$，由核的泛性质，我们可以得到唯一分解
\[
	\ker(g)\theta=(\ker \coker f)\psi=\im(f)\psi=f\psi=\ker(g)a\psi,
\]
其中$\im(f)=f$来自于$f$是一个单态。由于$\ker(g)$是单态，所以$\theta=a\psi$. 此即泛性质，所以$a=\ker(\varphi)$. 同理，可以验证，$b=\coker \varphi$.

由于$\varphi=\im(\varphi)\coim(\varphi)=\coker(\ker \varphi)\ker(\coker \varphi)=\coker(a)\ker(b)$. 因此$[\coker(a)]=[\ker(b)]$. 实际上，如果我们选取同构的核（余核），则由$\varphi$分解的唯一性，即Proposition \ref{uni}，我们将得到$[\coker(a)]\cong [\ker(b)]$.

现在我们考虑一般情形，因为$f=\ker(g)a$，其中$\ker(g)$是一个单态，由Lemma \ref{lem1}，存在唯一的态射$a'$使得$a=a'\coim(f)$以及$\im(f)=\ker(g)a'$. 即如下交换图成立
\[
\begin{xy}
	\xymatrix{
	\cdot \ar[r]^{\coim f} \ar[rrd]_a&\cdot \ar[r]^{\im f} \ar[rd]^{a'}&\cdot \\
	&&\cdot \ar[u]_{\ker g}
	}
\end{xy}
\]
由于$ta=0$等价于$ta'\coim(f)=0$等价于$ta'=0$，所以$\coker(a)=\coker(a')$. 同理（对偶地），我们有$b'$使得$b=\im(g)b'$且$\coim(g)=b' \coker(f)$，所以$\ker(b')=\ker(b)$.

现在，考虑交换图
\[
\begin{xy}
	\xymatrix{
	&&\cdot \ar[rrd]^{b'}&&\\
	\cdot \ar[rr]^{\im f} \ar[rrd]_{a'}&&\cdot \ar[rr]^{\coim g}\ar[u]^{\coker f}&&\cdot\\
	&&\cdot \ar[u]_{\ker g}&&
	}
\end{xy}
\]
由于$\im f$是单态而$\coim g$是满态，所以按照之前证明的特殊情况的结论，$[\coker(a')]\cong [\ker(b')]$. 

最后，由于$\coker(a)=\coker(a')$且$\ker(b')=\ker(b)$，所以我们就得到了$[\coker(a)]\cong [\ker(b)]$.
\end{proof}

上图中的$[\coker(a)]$或者$[\ker(b)]$，我们经常会记作$\ker(g)/\im(f)$.