\renewcommand\chapterimg{../Pictures/5.png}

\chapter{模（二）}

\section{准素分解}

\para 考虑一个$R$-模$M$，如果对$r\in R$存在一个非零的$m\in M$使得$rm=0$，则这个$r$称为$M$的一个零因子。对固定的$m\in M$，使得$rm=0$的$r\in R$的集合记作$\ann(m)$. 这是一个$R$中的理想，因为$ram=r0=0$对$a\in \ann(m)$成立。设$S$是$M$的一个子集，定义$\ann(S)=\bigcap_{m\in S}\ann(m)$.

设$M$是一个$R$-模，设$\mathfrak{a}\subset \ann(M)$是$R$中的一个理想，则$M$可以看成一个$R/\mathfrak{a}$-模，因为$(r+\mathfrak{a})m=rm$. 特别地，$M$是一个$R/\ann(M)$-模，此时，如果$rm=0$，则可以推出$r$和$m$中有一个零。

\para $\ann(m)$中的那些素理想，称之为$M$的associated primes，定义$\Ann_R(M)$为所有associated primes的集合，如果下标$R$是清楚的，我们会略去它。

当然有可能所有的$\ann(m)$都不是素理想，但是如果$R$是一个Noether环，则下面的引理保证了$\Ann(M)$非空。

\lem 设$\mathcal{P}$是所有形如$\ann(m)$的理想按照包含构成的一个偏序集，则$\mathcal{P}$中的极大元都是素理想。

\proof
	设$\ann(m)$是一个极大元，再设$r\notin \ann(m)$，即$rm\neq 0$. 很清楚，$\ann(m)\subset \ann(rm)$，所以由极大性可知$\ann(rm)=\ann(m)$. 现在如果$rs\in \ann(m)$但$r\notin \ann(m)$，则$srm=0$可知$s\in \ann(rm)=\ann(m)$，所以$\ann(m)$是一个素理想。
\qed

如果$R$是一个Noether环，则它的理想构成的非空子集一定存在极大元，这就保证了$\Ann(M)$非空。并且，如果$r$是$M$的一个零因子，含有$r$的那个极大的$\ann(m)$属于$\Ann(M)$，这就是说，任意的零因子必然属于$\Ann(M)$中的某个元素，或者如下包含关系
\[
	\bigcup_{0\neq m\in M}\ann(m)\subset \bigcup_{\mathfrak{a}\in \Ann(M)}\mathfrak{a}. 
\]

从这里开始，我们假设这节下面出现的环都是Noether环，除非特别申明。

\lem 设$M$是一个$R$-模，如果$\ann(m)$是素理想，则对$M$的子模$Rm$的任意非零子模$N$有$\ann(N)=\ann(m)$.

\proof
	显然，$\ann(m)\subset \ann(N)$. 由于有$R$-模同构$\psi: Rm\to R/\ann(m)$，所以$Rm$的任意非零子模$N$对应着$R/\ann(m)$的非零理想$\psi(N)$. 如果$r\in \ann(N)$，则$r\psi(N)=\psi(rN)=0$，因为$\psi(N)$非零且$R/\ann(m)$是整环，所以$r$在$R/\ann(m)$中的像为零，即是说$r\in \ann(M)$. 所以$\ann(N)\subset \ann(m)$.
\qed

\pro 如果我们有$R$-模的正合列$0\to M'\to M\to M''\to 0$，则我们有包含关系
\[
	\Ann(M')\subset \Ann(M)\subset \Ann(M')\cup \Ann(M'').
\]

\proof
	由于单同态并不会改变$\Ann$，所以可以将$M'$看成$M$的子模，所以第一个包含显然。对第二个包含，任取$\mathfrak{a}\in \Ann(M)-\Ann(M')$，我们要证明$\mathfrak{a}\in \Ann(M')$. 设$\mathfrak{a}=\ann(m)$，其中$m\in M$，由$m$生成的子模$Rm$同构于$R/\mathfrak{a}$. 考虑$N=Rm\cap M'$，他是$Rm$的子模，如果$N$非零，因为$\mathfrak{a}\notin \Ann(M')$，$\mathfrak{a}N\neq 0$，因此$\mathfrak{a}\not\subset \ann(N)=\ann(m)=\mathfrak{a}$，矛盾，所以只可能$Rm\cap M'=0$. 在这种情况下，$Rm$同构于他在$M''$中的像，所以$\mathfrak{a}\in \Ann(M'')$.
\qed

考虑$M=M'\oplus M''$的情况，由于$M'$和$M''$都有到$M$的单同态，所以$\Ann(M')\subset \Ann(M)$以及$\Ann(M'')\subset \Ann(M)$，继而他给出了$\Ann(M)=\Ann(M')\cup \Ann(M'')$.

\para 设$N$是$M$的一个子模，如果$\Ann(M/N)$只有一个元素，则称呼$N$是$M$的一个准素子模，如果$\Ann(M/N)=\{\mathfrak{p}\}$，则称呼$N$是$\mathfrak{p}$-准素的。

如果设$N_1$和$N_2$都是$\mathfrak{p}$-准素的，则$N_1\cap N_2$也是. 事实上，考虑单同态$M/(N_1\cap N_2)\to M/N_1\oplus M/N_2$，因此$\Ann(M/(N_1\cap N_2))\subset \Ann(M/N_1)\cup \Ann(M/N_2)=\{\mathfrak{p}\}\cup \{\mathfrak{p}\}=\{\mathfrak{p}\}$. 但是由于$\Ann(M/(N_1\cap N_2))$非空，所以$\Ann(M/(N_1\cap N_2))=\{\mathfrak{p}\}$.

经过有限次归纳可以得到：有限个$\mathfrak{p}$-准素子模的交依然是一个$\mathfrak{p}$-准素子模。

\lem 设$R$是Noether环，$M$是有限生成$R$-模，则$M$的不可约子模$N$是准素子模。

\proof
	如果$\Ann(M/N)$中至少存在两个素理想$\pp_1=\ann(\bar{m}_1)$和$\pp_2=\ann(\bar{m}_2)$，那么在$M/N$中有子模$R\bar{m}_1\cong R/\pp_1$和$R\bar{m}_2\cong R/\pp_2$. 如果$R\bar{m}_1\cap R\bar{m}_2$非零，则$R\bar{m}_1\cap R\bar{m}_2$作为$R\bar{m}_1$的非零子模，$\ann(R\bar{m}_1\cap R\bar{m}_2)=\pp_1$，作为$R\bar{m}_2$的非零子模，$\ann(R\bar{m}_1\cap R\bar{m}_2)=\pp_2$，矛盾，于是推出$R\bar{m}_1\cap R\bar{m}_2=\{\bar{0}\}$. 回到$M$中的原像，我们就可以知道$N$可以写成两个$M$的子模的交，这与$N$不可约矛盾。
\qed

准素子模的重要性来自于下面这个定理，他被称为准素分解。

\theo 设$R$是Noether环，$M$是有限生成$R$-模，如果$N$是$M$的一个真子模，那么他是有限个准素子模的交。

\proof
	由于Noether环上的有限生成模是Noether模，回忆Proposition \eqref{irrde}，$N$可以写成$M$中的有限个不可约子模的交的形式，而每一个不可约子模都是准素子模。
\qed

\section{主理想整环上的有限生成模}

\para 在很久之前，我们已经有了一个结论：域上的有限生成模是自由模。这节就将推广这个结论。

\section{微分模}

\para 设$S$是一个环，$M$是一个$S$-模，则一个加法群同态$d:S\to M$被称为一个导子，如果它满足Leibniz法则
\[
	d(fg)=fdg+gdf.
\]
如果$S$是一个$R$-代数，设$\varphi:R\to S$是定义代数的环同态，那么$r\cdot m=\varphi(r)m$定义出了$M$上的一个$R$-模结构。此时，导子$d$如果是$R$-模同态，则称呼$d$是$R$-线性的。$S$到$M$所有的$R$-线性导子构成了一个$R$-模。

由于$d(1\cdot 1)=d(1)+d(1)$，因此对任意的导子有$d(1)=0$. 如果$d$是$R$-线性的，对$r\in R$，我们有$d(r)=rd(1)=0$. 设$s\in S$，则$d(s^n)=ns^{n-1}d(s)$，这个可以用Leibniz法则直接计算得到。

如果$\varphi:R\to S$是一个满同态，如果将$S$看成$R$-代数，则$\varphi(r)=r\cdot 1$，于是从上面的构造有$d(r\cdot 1)=rd(1)=0$，所以此时$\Omega_{S/R}=\{0\}$.

\pro 给定环$R$和$R$-代数$S$，则存在一个$S$-模$\Omega_{S/R}$和一个$R$-线性的导子$d:S\to R$使得任意的$S$-模$M$与$R$-线性导子$\delta: S\to M$都存在唯一的$R$-线性映射$\varphi:\Omega_{S/R}\to M$使得分解
\[
	\delta:S\xrightarrow{d}\Omega_{S/R}\xrightarrow{\varphi}M
\]
成立。

\proof
	考虑集合$\{d(f)\,:\, f\in S\}$生成的自由$S$-模$M$，再考虑其中由
	\[
	d(fg)-fd(g)-gd(f),\quad d(rf)-rd(f),\quad d(f+g)-d(f)-d(g)
	\]
	生成的子模$N$，于是$\Omega_{S/R}$就被构造为$M/N$，而$d:f\mapsto d(f)$很容易检验这是一个$R$-线性导子。

	泛性质的检验从构造是简单的。
\qed

今后，$d(f)$的括号不产生理解上的差异的时候会略去记成$df$. 上面定义的模就被称为$S$的微分模。由泛性质，微分模在同构意义下唯一。

\para 在继续关于微分模的讨论之前，先谈谈他相关的几何概念。在光滑流形$M$上，我们知道，给定一个光滑函数$f:M\to \mathbb{R}$，那么在每一点$f_{*p}:T_pM\to T_{f(p)}\mathbb{R}=\mathbb{R}$将$p$点的切矢量$v$变成了一个数$f_{*p}(v)=v(f)=df(v)(p)$，然后让$p$在流形上跑动起来，这样就得到了$f_*=df$实际上是余切丛的一个光滑截面。

记$\mathcal{C}^\infty(M)$是流形$M$上的光滑函数环，这是一个$\mathbb{R}$-代数，而$\Gamma(T^*M)$是$M$的余切丛的光滑截面构成的集合，他是一个加法群，通过逐点定义数乘，可以赋予一个$\mathcal{C}^\infty(M)$-模结构，此时$f\mapsto f_*$就是一个导子。

由微分模的泛性质，因此存在一个$\mathcal{C}^\infty(M)$-模同态$\Omega_{\mathcal{C}^\infty(M)/\mathbb{R}}\to \Gamma(T^*M)$. 由于$T^*M$与$\Gamma(T^*M)$是等价的对象，所以$\Omega_{\mathcal{C}^\infty(M)/\mathbb{R}}$这里就可以理解成余切丛。他的对偶就可以理解成切丛。

\para 设$S$是一个有限生成$R$-代数，他被$\{f_1,\cdots,f_n\}$生成，那么任意的单项式$f_1^{k_1}\cdots f_n^{k_n}\in S$求导后有
\[
	d(f_1^{k_1}\cdots f_n^{k_n})=\sum_{i=1}^n f_1^{k_1}\cdots d(f_i^{k_i})\cdots f_n^{k_n},
\]
如果$k_i=0$则$d(f_i^{k_i})=0$，如果$k_i>0$则$d(f_i^{k_i})=f_i^{k_i-1}df_i$，所以这个单项式可以由$\{df_i\}$线性组合而言，继而$\Omega_{S/R}$就可以由$\{df_i\}$线性组合。

因此，我们求出了，如果$S=R[x_1,\cdots,x_n]$，则$\Omega_{S/R}=\bigoplus_{i=1}^n Sdx_i$，即由$\{dx_i\}$生成的自由模。

\para 回忆一个$R$-代数$S$实际上是一个三元组$(R,S,\varphi)$，其中$\varphi:R\to S$是一个环同态。考虑所有这样三元组构成的范畴，其中态射$\rho:(R,S,\varphi)\to (R',S',\varphi')$是两个环同态$\rho_R:R\to R'$以及$\rho_S:S\to S'$，它们需要满足交换图
\[
\begin{xy}
	\xymatrix
	{
		R\ar[rr]^{\rho_R} \ar[d]_{\varphi}&&R' \ar[d]^{\varphi'}\\
		S\ar[rr]^{\rho_S}&&S'
	}
\end{xy}
\]
不难检验复合的成立。

由于每个代数都可以考虑它的微分模，那么我们自然可以考虑微分模在上述态射下的变化，为此，我们记$\Omega(S,R,\varphi)$来代替$\Omega_{S/R}$，则上述态射诱导了如下的交换图
\[
\begin{xy}
	\xymatrix
	{
		R\ar[r]^{\varphi}\ar[d]_{\rho_R}&S\ar[rr]-^{d} \ar[d]_{\rho_S}&&\Omega(S,R,\varphi) \ar[d]\\
		R'\ar[r]^{\varphi'}&S'\ar[rr]-^{d'}&&\Omega(S',R',\varphi')
	}
\end{xy}
\]
没有标记的那个同态来自于微分模的泛性质，因此，我们可以将$\Omega$看成一个代数范畴到模范畴的一个函子。

\para 考虑$R=R'$的情况，此时代数的态射约化成了$S\to S'$的一个环同态，换而言之，即考虑三个环
$R\to S\to T$的情况。

考虑$T$-模$\Omega_{T/R}$和$\Omega_{T/S}$，从构造，他们都可以写成自由$T$-模$M$关于两个子模$N_R$和$N_S$的商模，由于$S$-线性可以推出$R$-线性，所以$N_R\subset N_S$. 从商同态$M\to M/N_S=\Omega_{T/S}$可以诱导出满同态$\psi:\Omega_{T/R}=M/N_R\to \Omega_{T/S}$，具体到元素就是$\psi:dc\mapsto dc$. 

对$S$-模$\Omega_{S/R}$，我们可以标量扩张成一个$T$-模，通过$T\otimes_S \Omega_{S/R}$. 对环同态$\pi:S\to T$. 由于同样都是$R$-线性的，所以通过$\varphi:t\otimes ds\mapsto tds$可以给出$R$-线性的$T$-模同态$\varphi:T\otimes_S \Omega_{S/R}\to \Omega_{T/R}$.

现在我们来求$\ker\psi$，由构造，他就是$N_S/N_R$. $N_S$由所有$d(fg)-df-dg$, $d(fg)-df-dg$和$d(f+g)-df-dg$生成，由于$d(fg)-df-dg$, $d(f+g)-df-dg\in N_R$, 所以$\ker\psi$被$d(st)-sdt=tds$生成元，其中$s\in S$，由于$tds=\varphi(t\otimes ds)$，于是$\ker\psi=\im\varphi$.

综上，我们有正合列
\[
	T\otimes_S \Omega_{S/R}\xrightarrow{\varphi} \Omega_{T/R}\xrightarrow{\varphi} \Omega_{T/S}\to 0,
\]
其中$\varphi:t\otimes ds\mapsto tds$以及$\psi:dt\mapsto dt$.

利用这个正合列，当$R\to S$是一个满同态的时候，由于此时$\Omega_{S/R}=\{0\}$，所以$\Omega_{T/R}\cong \Omega_{T/S}$.

\para 依然考虑三个环$R\to S\to T$的情况，但此时假设$\pi:S\to T$是一个满射，因此$\Omega_{T/S}=0$，上述正合列就只剩
\[
	T\otimes_S \Omega_{S/R}\xrightarrow{\psi} \Omega_{T/R}\to 0,
\]
此时$\psi$是一个满同态。

设$I=\ker \pi$，由于$\pi:S\to T$满同态，由于张量积是右正和的，所以$1\otimes \pi:\Omega_{S/R}=S\otimes\Omega_{S/R}\to T\otimes\Omega_{S/R}$是一个满同态，并且$\ker(1\otimes \pi)=I\Omega_{S/R}$，所以$\Omega_{S/R}/I\Omega_{S/R}\cong T\otimes\Omega_{S/R}$，这个同构具体写出来就是$df\to 1\otimes df$. 利用这个同构，可以断言$T\otimes_S\Omega_{S/R}$由$\{1\otimes_S ds\,:\,s\in S\}$张成。

考虑标准导子$d:S\to \Omega_{S/R}$限制在$I$上得到的$S$-模同态$d|_I$. 任取$s\in S$以及$r\in I$，有$d(rs)=sdr+rds$，在$\Omega_{S/R}/I\Omega_{S/R}\cong T\otimes\Omega_{S/R}$中$rds$将被模去，这样$d|_I$就诱导了一个$S$-模同态$I\to \Omega_{S/R}/I\Omega_{S/R}$，我们依然记作$d$。如果$s\in I$，则$d(rs)$在$\Omega_{S/R}/I\Omega_{S/R}$中为零，因此$d(I^2)=0$. 由商模的泛性质，他诱导了$S$-模同态$d:I/I^2\to \Omega_{S/R}/I\Omega_{S/R}$，他同时也是$S/I=T$-模同态。综上，我们就有一列$T$-模同态
\[
	I/I^2\xrightarrow{D} T\otimes_S\Omega_{S/R}\xrightarrow{\varphi} \Omega_{T/R}\to 0,
\]
其中$D:f\mapsto 1\otimes df$. 下面我们证明这还是正合列。

\pro 设$R\to S\to T$是三个环，并且$\pi:S\to T$是满同态，记$I=\ker\pi$，我们有正合列
\[
	I/I^2\xrightarrow{D} T\otimes_S\Omega_{S/R}\xrightarrow{\varphi} \Omega_{T/R}\to 0,
\]
其中$D:f\mapsto 1\otimes df$，以及$\varphi:1\otimes df\mapsto df$.

\proof
	只要求$\ker \varphi$. 由于$T\otimes_S\Omega_{S/R}$由$\{1\otimes_S ds\,:\,s\in S\}$张成，并且，由于$S\to T$是满同态，所以$\Omega_{T/R}$由$\{ds\,:\,s\in S\}$张成。于是$\varphi$将生成元$1\otimes_S ds$变成生成元$ds$，并且$T\otimes_S\Omega_{S/R}$和$\Omega_{T/R}$满足相同的Leibniz法则和$R$-线性性，所以$\ker \varphi$由那些$1\otimes ds\neq 0$张成，其中$ds=0\in\Omega_{T/R}$，如果$1\otimes ds\neq 0$，则只可能$s\in I$. 此时$1\otimes ds=Ds\in\im D$，所以$\ker\varphi=\im D$. 
\qed

利用同构基本定理，上面的正合列给出了同构
\[
	\Omega_{T/R}\cong \coker\left(I/I^2\xrightarrow{D} T\otimes_S\Omega_{S/R}\right).
\]
当$T$是一个有限生成$R$-代数，即$T=R[x_1,\cdots,x_n]/I$，取$S=R[x_1,\cdots,x_n]$，则
\[
	T\otimes_S\Omega_{S/R}=T\otimes_S\bigoplus_{i=1}^n Sx_i=\bigoplus_{i=1}^n Tx_i,
\]
所以
\[
	\Omega_{T/R}\cong \coker\left(I/I^2\xrightarrow{D} \bigoplus_{i=1}^n Tx_i\right),
\]
此时$\Omega_{T/R}$是一个有限生成$T$-模。